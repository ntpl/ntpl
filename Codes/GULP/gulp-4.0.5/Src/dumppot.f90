  subroutine dumppot(iout)
!
!  Dump out potential parameters for restart file
!
!   7/01 Created from dumpgen to make dumpgen smaller
!   8/02 Lennard-Jones shifted form added
!   7/03 Call to dumpbo added
!  11/03 ndennat/ndentyp replaced
!  11/03 Output of eam_alloy option added
!   3/04 Squaredharmonic potential added
!   5/04 Tsuneyuki potential added
!  11/04 linspec is now species-wise and used to screen
!        which terms to output
!   7/05 Scaling parameter for eam functions added
!   7/05 Order of deallocations reversed
!   9/05 Voter density for EAM added
!  10/05 Option for Voter style tapering added to Morse
!  11/05 EAM potential shift added
!   3/06 Modified to allow for density component number
!   3/06 Poly harmonic potential added
!   3/06 Number of flags allowed for in itmp increased to 10
!   4/06 Species specific density added
!   5/06 Modified for neamfnspec
!   7/06 Voter suboption removed from Morse 
!   7/06 Modified for sixbody potentials
!   8/06 Bond type words added to output
!   9/06 Use of literal symbols from input introduced
!  11/06 qoverr2 potential added
!   1/07 nlibseps & nlibatab added
!   1/07 Position of nodump sub-option moved to start of line
!   1/07 Force constant potential added
!   1/07 Amide bond type added
!   2/07 Johnson and Glue EAM models added
!   2/07 Glue density added
!   3/07 srglue potential added
!   4/07 UFF parameters added
!   5/07 nUFFtype added
!   5/07 UFFtor added
!   5/07 Bond charge increments added
!   5/07 Morse etaper option added
!   5/07 eVoter EAM density added
!   5/07 Foiles EAM functional added
!   5/07 Bug in pointer to EAM functional fitting flags corrected
!   7/07 Call to dumpbo triggered for reaxFF
!   7/07 Dump of plane potentials added
!   9/07 Dump of L-J potentials with non-integer exponents added
!  11/07 Dump of Mei-Davenport potential added
!  11/07 Dump of Mei-Davenport EAM density added & size of itmps increased
!  11/07 Dump of Mei-Davenport EAM functional added & size of itmps increased
!  11/07 Error in fitting flag setting for final flag of Foiles functional fixed
!   3/08 erferfc, erf and reperfc potentials added
!   5/08 New UFF generators for OOP added
!   5/08 UFF chi added
!  10/08 MEAM modifications added - denpar increased in dimension
!  11/08 nfvar3 added for MEAM case to point to order
!  11/08 Third dimension added to itmps for MEAM case
!  11/08 Baskes form of exponential density added
!  11/08 Baskes form of functional added
!  11/08 Format statement for the quadratic and quartic EAM densities corrected
!  12/08 eammeamcoeff array changed from density to function related
!  12/08 rho0 added to Baskes form of functional
!   1/09 Arrays apot, bpot, cpot & dpot replaced by new 2-D array twopot
!   1/09 Use of nfvar for two-body potentials modified
!   1/09 leshift/lgshift logicals introduced to replace use of tpot(3/4,) for energy
!        and gradient shifts
!   1/09 Baskes potential added
!   1/09 VBO_twobody potential added
!   1/09 VBO density added
!   1/09 VBO functional added
!   3/09 Output of force constant potential corrected by removing xyzlabel
!   4/09 Modified to handle neamfnmeamtype/neamfnmeamcombotype
!   4/09 d term added to Baskes potental
!   4/09 MEAM screening output added
!   6/09 Module name changed from three to m_three
!   7/09 libd keyword extented to EAM potentials
!   7/09 exppowers potential added
!   8/09 Grimme_C6 potential added
!   9/09 Belashchekno EAM functional added
!   9/09 Maximum order of polynomial potential increased to 8
!   9/09 r0 added for standard polynomial potential
!  10/09 Format of Rydberg potential modified
!   1/10 One-body potential added
!   2/10 Central force model potentials added
!   3/10 Rule based potentials excluded from dump to avoid duplication
!   4/10 Format of ljbuffered dump altered
!   5/10 gcoulomb potential added
!   9/10 Modified for EDIP case
!  10/11 Fpower density form added
!   1/12 g12 mmexc=5 option added
!   3/12 Error in writing of geometric sub-option for autogenerated epsilon-sigma LJ fixed
!   5/12 Becke_Johnson_C6 added
!
!  Conditions of use:
!
!  GULP is available free of charge to academic institutions
!  and non-commerical establishments only. Copies should be
!  obtained from the author only and should not be distributed
!  in any form by the user to a third party without the express
!  permission of the author. This notice applies to all parts
!  of the program, except any library routines which are
!  distributed with the code for completeness. All rights for
!  such routines remain with the original distributor.
!
!  No claim is made that this program is free from errors and
!  no liability will be accepted for any loss or damage that
!  may result. The user is responsible for checking the validity
!  of their results.
!
!  Copyright Curtin University 2012
!
!  Julian Gale, NRI, Curtin University, May 2012
!
  use bondcharge
  use bondorderdata, only : nboA, nboR, nbopot, nboQ, nboQ0
  use chargecoupled, only : nCCspec
  use control
  use current
  use eam
  use EDIPdata,      only : nEDIPspec
  use element
  use fitting
  use four
  use general
  use library
  use molecule
  use one
  use plane
  use polarise
  use reaxFFdata,   only : nreaxFFspec
  use shell
  use six,          only : nsix
  use species
  use splinedata
  use sutton
  use m_three
  use two
  use uffdata
  implicit none
!
!  Passed variables
!
  integer(i4),      intent(in)                  :: iout
!
!  Local variables
!
  character(len=5), dimension(:),     allocatable :: ctmp
  character(len=5)                                :: lab1
  character(len=5)                                :: lab2
  character(len=4)                                :: mmword
  character(len=3)                                :: meamword(2)
  character(len=5)                                :: mword(3)
  character(len=7)                                :: spltype(5)
  character(len=9)                                :: botyword(9)
  integer(i4)                                     :: i
  integer(i4)                                     :: ii
  integer(i4)                                     :: im
  integer(i4)                                     :: in
  integer(i4),      dimension(:),     allocatable :: itmp
  integer(i4),      dimension(:,:,:), allocatable :: itmps
  integer(i4)                                     :: itype1
  integer(i4)                                     :: itype2
  integer(i4)                                     :: j
  integer(i4)                                     :: k
  integer(i4)                                     :: l
  integer(i4)                                     :: maxitmp
  integer(i4)                                     :: maxleft
  integer(i4)                                     :: maxmiddle
  integer(i4)                                     :: mpt
  integer(i4)                                     :: nab
  integer(i4)                                     :: nat1
  integer(i4)                                     :: nat2
  integer(i4)                                     :: nati
  integer(i4)                                     :: nbondQo
  integer(i4)                                     :: nboty
  integer(i4)                                     :: nbotyptr(2)
  integer(i4)                                     :: nmptr
  integer(i4)                                     :: nmeamword
  integer(i4)                                     :: noneo
  integer(i4)                                     :: norder
  integer(i4)                                     :: np
  integer(i4)                                     :: npoto
  integer(i4)                                     :: npt
  integer(i4)                                     :: ns
  integer(i4)                                     :: nspo
  integer(i4)                                     :: nspook
  integer(i4)                                     :: nt
  integer(i4)                                     :: ntypi
  integer(i4)                                     :: nv
  integer(i4)                                     :: nv2
  integer(i4)                                     :: status
  logical                                         :: l14scale
  logical                                         :: lnoninteger
!
  data mword/'intra','inter','     '/
  data spltype/'       ','       ','cubic  ','quartic','quintic'/
  data botyword/'single   ','double   ','triple   ','quadruple','resonant', &
                'amide    ','regular  ','cyclic   ','exocyclic'/
!
!  Allocate local memory
!
  maxitmp = max(none,20*npote,10*nUFFspec,2*natab,2*nseps,2*nplanepot,nbondQ)
  allocate(ctmp(2*nspec),stat=status)
  if (status/=0) call outofmemory('dumppot','ctmp')
  allocate(itmp(maxitmp),stat=status)
  if (status/=0) call outofmemory('dumppot','itmp')
  maxleft   = max(3*nspec,7*neamspec,9+maxmeamorder)
  maxmiddle = max(maxeamden,neamfnspec)
  allocate(itmps(maxleft,maxmiddle,maxmeamorder),stat=status)
  if (status/=0) call outofmemory('dumppot','itmps')
!**************************
!  Variables for fitting  *
!**************************
  if (nfit.gt.0) then
    ns = 0
    do i = 1,nfit
      nt = nftyp(i)
      np = nfpot(i)
      if (nt.eq.1.and.np.eq.3) then
!
!  Shift
!
        ns = i
      endif
    enddo
    if (ns.gt.0) then
      write(iout,'(''variables'')')
      write(iout,'(''shift'')')
      write(iout,'(''end'')')
    endif
  endif
!************
!  Species  *
!************
  if (nlib.gt.0.and..not.llibdump) then
    nspo = nlibsp
  else
    nspo = nspec
  endif
!
!  Find out how many species were input
!
  nspook = 0
  do i = 1,nspo
    if (linspec(i)) nspook = nspook + 1
  enddo
!
!  Output species that were input
!
  if (nspook.gt.0) then
    write(iout,'(''species '',i3)') nspook
    do i = 1,nspo
      if (linspec(i)) then
        nati = natspec(i)
        ntypi = ntypspec(i)
        call label(nati,ntypi,lab1)
        if (lbrspec(i)) then
          if (nati.gt.maxele) then
            if (lqinspec(i)) then
              write(iout,'(a5,2x,''bshe'',2x,f10.6,2x,a16)') lab1,qlspec(i),libspec(i)
            else
              write(iout,'(a5,2x,''bshe'',2x,12x,a16)') lab1,libspec(i)
            endif
          else
            if (lqinspec(i)) then
              write(iout,'(a5,2x,''bcor'',2x,f10.6,2x,a16)') lab1,qlspec(i),libspec(i)
            else
              write(iout,'(a5,2x,''bcor'',2x,12x,a16)') lab1,libspec(i)
            endif
          endif
        else
          if (nati.gt.maxele) then
            if (lqinspec(i)) then
              write(iout,'(a5,2x,''shel'',2x,f10.6,2x,a16)') lab1,qlspec(i),libspec(i)
            else
              write(iout,'(a5,2x,''shel'',2x,12x,a16)') lab1,libspec(i)
            endif
          else
            if (lqinspec(i)) then
              write(iout,'(a5,2x,''core'',2x,f10.6,2x,a16)') lab1,qlspec(i),libspec(i)
            else
              write(iout,'(a5,2x,''core'',2x,12x,a16)') lab1,libspec(i)
            endif
          endif
        endif
      endif
    enddo
  endif
  if (nlib.gt.0.and..not.llibdump) then
    do i = 1,nlib
      write(iout,'(''library nodump '',a60)') libname(i)(1:60)
    enddo
    noneo = nlib1s
    npoto = nlib2s
  else
    noneo = none
    npoto = npote
  endif
!***************************
!  Polarisability Species  *
!***************************
  if (npolspec.gt.0) then
    write(iout,'(''polarisability '',i3)') npolspec
    do i = 1,npolspec
      nati = natpolspec(i)
      ntypi = ntyppolspec(i)
      call label(nati,ntypi,lab1)
      write(iout,'(a5,2x,''core'',2x,2(f10.6,1x))') lab1,dpolspec(i),qpolspec(i)
    enddo
  endif
!**************************
!  Interatomic potentials *
!**************************
  if (noneo.gt.0) then
    if (lfit) then
      do i = 1,noneo
        itmp(i) = 0
      enddo
      do i = 1,nfit
        nt = nftyp(i)
        np = nfpot(i)
        nv = nfvar(i)
        if (nt.eq.1.and.np.eq.38) then
          itmp(nv) = 1
        endif
      enddo
    endif
    do i = 1,noneo
!
!  General potential details
!
      nat1 = nspec11(i)
      itype1 = nptyp11(i)
      if (llibsymdump) then
        lab1 = symbol1(i)
      else
        call label(nat1,itype1,lab1)
      endif
      if (nat1.gt.maxele) then
        ctmp(1) = 'shel'
      else
        ctmp(1) = 'core'
      endif
!
!  Ashift
!
      write(iout,'(''ashift'')') 
      if (lfit) then
        write(iout,'(2x,a5,1x,a4,f16.8,1x,i1)') lab1,ctmp(1),onepot(i),itmp(i)
      else
        write(iout,'(2x,a5,1x,a4,f16.8)') lab1,ctmp(1),onepot(i)
      endif
    enddo
  endif
  if (npoto.gt.0) then
    if (lfit) then
      do i = 1,20*npoto
        itmp(i) = 0
      enddo
      do i = 1,nfit
        nt = nftyp(i)
        if (nt.eq.2) then
          np = nfpot(i)
          nv = nfvar(i)
          if (nv.le.20) then
            itmp(20*(np-1)+nv) = 1
          endif
        endif
      enddo
    endif
!
!  Loop over two-body potentials
!
    loop2body: do i = 1,npoto
!
!  Skip potentials that are not to be dumped because they were generated by rules
!
      if (lgenerated2(i)) cycle loop2body
!
!  Molecule options
!
      if (lintra(i).and..not.linter(i)) then
        nmptr = 1
      elseif (linter(i).and..not.lintra(i)) then
        nmptr = 2
      else
        nmptr = 0
      endif
!
!  Molecular mechanics options
!
      if (mmexc(i).eq.1) then
        mmword = 'bond'
      elseif (mmexc(i).eq.2) then
        mmword = 'x12 '
      elseif (mmexc(i).eq.3) then
        mmword = 'x13 '
      elseif (mmexc(i).eq.4) then
        mmword = 'o14 '
      elseif (mmexc(i).eq.5) then
        mmword = 'g14 '
      else
        mmword = '    '
      endif
!
!  1-4 scaling option
!
      l14scale = (scale14(i).lt.1.0_dp)
!
!  General potential details
!
      nat1 = nspec1(i)
      itype1 = nptyp1(i)
      if (llibsymdump) then
        lab1 = symbol2(1,i)
      else
        call label(nat1,itype1,lab1)
      endif
      if (nat1.gt.maxele) then
        ctmp(1) = 'shel'
      else
        ctmp(1) = 'core'
      endif
      nat2 = nspec2(i)
      itype2 = nptyp2(i)
      if (llibsymdump) then
        lab2 = symbol2(2,i)
      else
        call label(nat2,itype2,lab2)
      endif
      if (nat2.gt.maxele) then
        ctmp(2) = 'shel'
      else
        ctmp(2) = 'core'
      endif
!  
!  Set bond type words
!         
      nboty = 0
      if (n2botype(1,i).gt.0) then
        nboty = nboty + 1 
        nbotyptr(nboty) = n2botype(1,i)
      endif
      if (n2botype(2,i).gt.1) then
        nboty = nboty + 1 
        nbotyptr(nboty) = 6 + n2botype(2,i)
      endif
!
      if (nptype(i).eq.1) then
!
!  Buckingham
!
        if (leshift(i)) then
          if (lgshift(i)) then
            if (nmptr.gt.0) then
              if (l14scale) then
                write(iout,'(''buck grad '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                  mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''buck grad '',a5,1x,a4,2(1x,a9))')  &
                  mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            else
              if (l14scale) then
                write(iout,'(''buck grad '',a4,1x,f6.4,2(1x,a9))')  &
                  mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''buck grad '',a4,2(1x,a9))')  &
                  mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            endif
          else
            if (nmptr.gt.0) then
              if (l14scale) then
                write(iout,'(''buck energy '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                  mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''buck energy '',a5,1x,a4,2(1x,a9))')  &
                  mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            else
              if (l14scale) then
                write(iout,'(''buck energy '',a4,1x,f6.4,2(1x,a9))')  &
                  mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''buck energy '',a4,2(1x,a9))')  &
                  mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            endif
          endif
        else
          if (nmptr.gt.0) then
            if (l14scale) then
              write(iout,'(''buck '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
            else
              write(iout,'(''buck '',a5,1x,a4,2(1x,a9))')  &
                mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
            endif
          else
            if (l14scale) then
              write(iout,'(''buck'',1x,a4,1x,f6.4,2(1x,a9))')  &
                mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
            else
              write(iout,'(''buck'',1x,a4,2(1x,a9))')  &
                mmword,(botyword(nbotyptr(j)),j=1,nboty)
            endif
          endif
        endif
        if (lfit) then
          if (mmexc(i).eq.1) then
            write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,g14.8,1x,f8.6,1x,g14.8,3i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),(itmp(20*(i-1)+j),j=1,3)
          else
            write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,g14.8,1x,f8.6,1x,g14.8,2(1x,f5.2),3i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,3)
          endif
        else
          if (mmexc(i).eq.1) then
            write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,g15.9,1x,f8.6,1x,g13.7)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i)
          else
            write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,g15.9,1x,f8.6,1x,g13.7,2(1x,f5.2))') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),rpot2(i),rpot(i)
          endif
        endif
      elseif (nptype(i).eq.2) then
!
!  Lennard-Jones
!
        im = nint(tpot(1,i))
        in = nint(tpot(2,i))
        lnoninteger = (abs(tpot(1,i)-dble(im))+abs(tpot(2,i)-dble(in)).gt.1.0d-6)
        if (lcombine(i)) then
          if (leshift(i)) then
            if (lgshift(i)) then
              if (nmptr.gt.0) then
                if (l14scale) then
                  if (lnoninteger) then
                    write(iout,'(''lennard combine grad '',f7.4,1x,f7.4,1x,a5,1x,a4,1x,f6.4,2(1x,a9))') &
                      tpot(1,i),tpot(2,i),mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                  else
                    write(iout,'(''lennard combine grad '',i2,1x,i2,1x,a5,1x,a4,1x,f6.4,2(1x,a9))') &
                      im,in,mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                  endif
                else
                  if (lnoninteger) then
                    write(iout,'(''lennard combine grad '',f7.4,1x,f7.4,1x,a5,1x,a4,2(1x,a9))') &
                      tpot(1,i),tpot(2,i),mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                  else
                    write(iout,'(''lennard combine grad '',i2,1x,i2,1x,a5,1x,a4,2(1x,a9))') &
                      im,in,mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                  endif
                endif
              else
                if (l14scale) then
                  if (lnoninteger) then
                    write(iout,'(''lennard combine grad '',f7.4,1x,f7.4,1x,a4,1x,f6.4,2(1x,a9))') &
                      tpot(1,i),tpot(2,i),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                  else
                    write(iout,'(''lennard combine grad '',i2,1x,i2,1x,a4,1x,f6.4,2(1x,a9))') &
                      im,in,mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                  endif
                else
                  if (lnoninteger) then
                    write(iout,'(''lennard combine grad '',f7.4,1x,f7.4,1x,a4,2(1x,a9))') &
                      tpot(1,i),tpot(2,i),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                  else
                    write(iout,'(''lennard combine grad '',i2,1x,i2,1x,a4,2(1x,a9))') &
                      im,in,mmword,(botyword(nbotyptr(j)),j=1,nboty)
                  endif
                endif
              endif
            else
              if (nmptr.gt.0) then
                if (l14scale) then
                  if (lnoninteger) then
                    write(iout,'(''lennard combine ener '',f7.4,1x,f7.4,1x,a5,1x,a4,1x,f6.4,2(1x,a9))') &
                      tpot(1,i),tpot(2,i),mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                  else
                    write(iout,'(''lennard combine ener '',i2,1x,i2,1x,a5,1x,a4,1x,f6.4,2(1x,a9))') &
                      im,in,mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                  endif
                else
                  if (lnoninteger) then
                    write(iout,'(''lennard combine ener '',f7.4,1x,f7.4,1x,a5,1x,a4,2(1x,a9))') &
                      tpot(1,i),tpot(2,i),mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                  else
                    write(iout,'(''lennard combine ener '',i2,1x,i2,1x,a5,1x,a4,2(1x,a9))') &
                      im,in,mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                  endif
                endif
              else
                if (l14scale) then
                  if (lnoninteger) then
                    write(iout,'(''lennard combine ener '',f7.4,1x,f7.4,1x,a4,1x,f6.4,2(1x,a9))') &
                      tpot(1,i),tpot(2,i),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                  else
                    write(iout,'(''lennard combine ener '',i2,1x,i2,1x,a4,1x,f6.4,2(1x,a9))') &
                      im,in,mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                  endif
                else
                  if (lnoninteger) then
                    write(iout,'(''lennard combine ener '',f7.4,1x,f7.4,1x,a4,2(1x,a9))') &
                      tpot(1,i),tpot(2,i),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                  else
                    write(iout,'(''lennard combine ener '',i2,1x,i2,1x,a4,2(1x,a9))') &
                      im,in,mmword,(botyword(nbotyptr(j)),j=1,nboty)
                  endif
                endif
              endif
            endif
          else
            if (nmptr.gt.0) then
              if (l14scale) then
                if (lnoninteger) then
                  write(iout,'(''lennard combine '',f7.4,1x,f7.4,1x,a5,1x,a4,1x,f6.4,2(1x,a9))') &
                    tpot(1,i),tpot(2,i),mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''lennard combine '',i2,1x,i2,1x,a5,1x,a4,1x,f6.4,2(1x,a9))') &
                    im,in,mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                endif
              else
                if (lnoninteger) then
                  write(iout,'(''lennard combine '',f7.4,1x,f7.4,1x,a5,1x,a4,2(1x,a9))') &
                    tpot(1,i),tpot(2,i),mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''lennard combine '',i2,1x,i2,1x,a5,1x,a4,2(1x,a9))') &
                    im,in,mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                endif
              endif
            else
              if (l14scale) then
                if (lnoninteger) then
                  write(iout,'(''lennard combine '',f7.4,1x,f7.4,1x,a4,1x,f6.4,2(1x,a9))') &
                    tpot(1,i),tpot(2,i),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''lennard combine '',i2,1x,i2,1x,a4,1x,f6.4,2(1x,a9))') &
                    im,in,mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                endif
              else
                if (lnoninteger) then
                  write(iout,'(''lennard combine '',f7.4,1x,f7.4,1x,a4,2(1x,a9))') &
                    tpot(1,i),tpot(2,i),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''lennard combine '',i2,1x,i2,1x,a4,2(1x,a9))') &
                    im,in,mmword,(botyword(nbotyptr(j)),j=1,nboty)
                endif
              endif
            endif
          endif
          if (mmexc(i).eq.1) then
            write(iout,'(2(a5,1x,a4,1x))') lab1,ctmp(1),lab2,ctmp(2)
          else
            write(iout,'(2(a5,1x,a4,1x),2(f6.3,1x))') lab1,ctmp(1),lab2,ctmp(2),rpot2(i),rpot(i)
          endif
        else
          if (leshift(i)) then
            if (lgshift(i)) then
              if (nmptr.gt.0) then
                if (l14scale) then
                  if (lnoninteger) then
                    write(iout,'(''lennard grad '',f7.4,1x,f7.4,1x,a5,1x,a4,1x,f6.4,2(1x,a9))') &
                      tpot(1,i),tpot(2,i),mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                  else
                    write(iout,'(''lennard grad '',i2,1x,i2,1x,a5,1x,a4,1x,f6.4,2(1x,a9))') &
                      im,in,mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                  endif
                else
                  if (lnoninteger) then
                    write(iout,'(''lennard grad '',f7.4,1x,f7.4,1x,a5,1x,a4,2(1x,a9))') &
                      tpot(1,i),tpot(2,i),mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                  else
                    write(iout,'(''lennard grad '',i2,1x,i2,1x,a5,1x,a4,2(1x,a9))') &
                      im,in,mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                  endif
                endif
              else
                if (l14scale) then
                  if (lnoninteger) then
                    write(iout,'(''lennard grad '',f7.4,1x,f7.4,1x,a4,1x,f6.4,2(1x,a9))') &
                      tpot(1,i),tpot(2,i),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                  else
                    write(iout,'(''lennard grad '',i2,1x,i2,1x,a4,1x,f6.4,2(1x,a9))') &
                      im,in,mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                  endif
                else
                  if (lnoninteger) then
                    write(iout,'(''lennard grad '',f7.4,1x,f7.4,1x,a4,2(1x,a9))') &
                      tpot(1,i),tpot(2,i),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                  else
                    write(iout,'(''lennard grad '',i2,1x,i2,1x,a4,2(1x,a9))') &
                      im,in,mmword,(botyword(nbotyptr(j)),j=1,nboty)
                  endif
                endif
              endif
            else
              if (nmptr.gt.0) then
                if (l14scale) then
                  if (lnoninteger) then
                    write(iout,'(''lennard ener '',f7.4,1x,f7.4,1x,a5,1x,a4,1x,f6.4,2(1x,a9))') &
                      tpot(1,i),tpot(2,i),mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                  else
                    write(iout,'(''lennard ener '',i2,1x,i2,1x,a5,1x,a4,1x,f6.4,2(1x,a9))') &
                      im,in,mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                  endif
                else
                  if (lnoninteger) then
                    write(iout,'(''lennard ener '',f7.4,1x,f7.4,1x,a5,1x,a4,2(1x,a9))') &
                      tpot(1,i),tpot(2,i),mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                  else
                    write(iout,'(''lennard ener '',i2,1x,i2,1x,a5,1x,a4,2(1x,a9))') &
                      im,in,mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                  endif
                endif
              else
                if (l14scale) then
                  if (lnoninteger) then
                    write(iout,'(''lennard ener '',f7.4,1x,f7.4,1x,a4,1x,f6.4,2(1x,a9))') &
                      tpot(1,i),tpot(2,i),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                  else
                    write(iout,'(''lennard ener '',i2,1x,i2,1x,a4,1x,f6.4,2(1x,a9))') &
                      im,in,mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                  endif
                else
                  if (lnoninteger) then
                    write(iout,'(''lennard ener '',f7.4,1x,f7.4,1x,a4,2(1x,a9))')  &
                      tpot(1,i),tpot(2,i),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                  else
                    write(iout,'(''lennard ener '',i2,1x,i2,1x,a4,2(1x,a9))')  &
                      im,in,mmword,(botyword(nbotyptr(j)),j=1,nboty)
                  endif
                endif
              endif
            endif
          else
            if (nmptr.gt.0) then
              if (l14scale) then
                if (lnoninteger) then
                  write(iout,'(''lennard '',f7.4,1x,f7.4,1x,a5,1x,a4,1x,f6.4,2(1x,a9))') &
                    tpot(1,i),tpot(2,i),mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''lennard '',i2,1x,i2,1x,a5,1x,a4,1x,f6.4,2(1x,a9))') &
                    im,in,mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                endif
              else
                if (lnoninteger) then
                  write(iout,'(''lennard '',f7.4,1x,f7.4,1x,a5,1x,a4,2(1x,a9))') &
                    tpot(1,i),tpot(2,i),mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''lennard '',i2,1x,i2,1x,a5,1x,a4,2(1x,a9))') &
                    im,in,mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                endif
              endif
            else
              if (l14scale) then
                if (lnoninteger) then
                  write(iout,'(''lennard '',f7.4,1x,f7.4,1x,a4,1x,f6.4,2(1x,a9))')  &
                    tpot(1,i),tpot(2,i),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''lennard '',i2,1x,i2,1x,a4,1x,f6.4,2(1x,a9))')  &
                    im,in,mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                endif
              else
                if (lnoninteger) then
                  write(iout,'(''lennard '',f7.4,1x,f7.4,1x,a4,2(1x,a9))')  &
                    tpot(1,i),tpot(2,i),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''lennard '',i2,1x,i2,1x,a4,2(1x,a9))')  &
                    im,in,mmword,(botyword(nbotyptr(j)),j=1,nboty)
                endif
              endif
            endif
          endif
          if (lfit) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),2(g14.8,1x),2i2)') &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),(itmp(20*(i-1)+j),j=1,2)
            else
              write(iout,'(2(a5,1x,a4,1x),2(g14.8,1x),2(f6.3,1x),2i2)') &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,2)
            endif
          else
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),2(g14.8,1x))') &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i)
            else
              write(iout,'(2(a5,1x,a4,1x),2(g14.8,1x),2(f6.3,1x))') &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),rpot2(i),rpot(i)
            endif
          endif
        endif
      elseif (nptype(i).eq.3.or.nptype(i).eq.4) then
!
!  Morse
!
        if (leshift(i)) then
          if (lgshift(i)) then
            if (nmptr.gt.0) then
              if (l14scale) then
                write(iout,'(''morse grad '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                  mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''morse grad '',a5,1x,a4,2(1x,a9))')  &
                  mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            else
              if (l14scale) then
                write(iout,'(''morse grad'',1x,a4,1x,f6.4,2(1x,a9))')  &
                  mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''morse grad'',1x,a4,2(1x,a9))')  &
                  mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            endif
          else
            if (nmptr.gt.0) then
              if (l14scale) then
                write(iout,'(''morse energy '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                  mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''morse energy '',a5,1x,a4,2(1x,a9))')  &
                  mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            else
              if (l14scale) then
                write(iout,'(''morse energy'',1x,a4,1x,f6.4,2(1x,a9))')  &
                  mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''morse energy'',1x,a4,2(1x,a9))')  &
                  mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            endif
          endif
        else
          if (nmptr.gt.0) then
            if (l14scale) then
              write(iout,'(''morse '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
            else
              write(iout,'(''morse '',a5,1x,a4,2(1x,a9))')  &
                mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
            endif
          else
            if (l14scale) then
              write(iout,'(''morse'',1x,a4,1x,f6.4,2(1x,a9))')  &
                mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
            else
              write(iout,'(''morse'',1x,a4,2(1x,a9))')  &
                mmword,(botyword(nbotyptr(j)),j=1,nboty)
            endif
          endif
        endif
        if (lfit) then
          if (mmexc(i).eq.1) then
            write(iout,'(2(a5,1x,a4,1x),g13.8,1x,g10.5,1x,f8.5,1x,f7.4,1x,3i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),twopot(4,i),(itmp(20*(i-1)+j),j=1,3)
          else
            write(iout,'(2(a5,1x,a4,1x),g13.8,1x,g10.5,1x,f8.5,1x,f7.4,'' &'')') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),twopot(4,i)
            write(iout,'(2(1x,f6.3),1x,3i2)') rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,3)
          endif
        else
          if (mmexc(i).eq.1) then
            write(iout,'(2(a5,1x,a4,1x),g13.8,1x,g10.5,1x,f8.5,1x,f7.4)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),twopot(4,i)
          else
            write(iout,'(2(a5,1x,a4,1x),g13.8,1x,g10.5,1x,f8.5,1x,f7.4,2(1x,f6.3))') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),twopot(4,i),rpot2(i),rpot(i)
          endif
        endif
      elseif (nptype(i).eq.5.or.nptype(i).eq.6) then
!
!  Harmonic
!
        if (twopot(3,i).ne.0.0_dp.and.twopot(4,i).ne.0.0_dp) then
          if (leshift(i)) then
            if (lgshift(i)) then
              if (nmptr.gt.0) then
                if (l14scale) then
                  write(iout,'(''harmonic k3 k4 grad '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                    mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''harmonic k3 k4 grad '',a5,1x,a4,2(1x,a9))')  &
                    mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                endif
              else
                if (l14scale) then
                  write(iout,'(''harmonic k3 k4 grad '',a4,1x,f6.4,2(1x,a9))')  &
                    mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''harmonic k3 k4 grad '',a4,2(1x,a9))')  &
                    mmword,(botyword(nbotyptr(j)),j=1,nboty)
                endif
              endif
            else
              if (nmptr.gt.0) then
                if (l14scale) then
                  write(iout,'(''harmonic k3 k4 energy '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                    mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''harmonic k3 k4 energy '',a5,1x,a4,2(1x,a9))')  &
                    mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                endif
              else
                if (l14scale) then
                  write(iout,'(''harmonic k3 k4 energy '',a4,1x,f6.4,2(1x,a9))')  &
                    mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''harmonic k3 k4 energy '',a4,2(1x,a9))')  &
                    mmword,(botyword(nbotyptr(j)),j=1,nboty)
                endif
              endif
            endif
          else
            if (nmptr.gt.0) then
              if (l14scale) then
                write(iout,'(''harmonic k3 k4 '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                  mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''harmonic k3 k4 '',a5,1x,a4,2(1x,a9))')  &
                  mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            else
              if (l14scale) then
                write(iout,'(''harmonic k3 k4 '',a4,1x,f6.4,2(1x,a9))')  &
                  mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''harmonic k3 k4 '',a4,2(1x,a9))')  &
                  mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            endif
          endif
          if (lfit) then
            ii = itmp(20*(i-1)+2)
            itmp(20*(i-1)+2) = itmp(20*(i-1)+3)
            itmp(20*(i-1)+3) = itmp(20*(i-1)+4)
            itmp(20*(i-1)+4) = ii
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),4(g10.5,1x),f4.2,'' &'')')  &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(3,i),twopot(4,i),twopot(2,i),tpot(1,i)
              write(iout,'(4i2)') (itmp(20*(i-1)+j),j=1,4)
            else
              write(iout,'(2(a5,1x,a4,1x),4(g10.5,1x),f4.2,'' &'')') &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(3,i),twopot(4,i),twopot(2,i),tpot(1,i)
              write(iout,'(2(1x,f6.3),4i2)') rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,4)
            endif
          else
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),4(g10.5,1x),f4.2)') &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(3,i),twopot(4,i),twopot(2,i),tpot(1,i)
            else
              write(iout,'(2(a5,1x,a4,1x),4(g10.5,1x),'' &'')') &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(3,i),twopot(4,i),twopot(2,i)
              write(iout,'(f4.2,2(1x,f6.3))')tpot(1,i),rpot2(i),rpot(i)
            endif
          endif
        elseif (twopot(3,i).ne.0.0_dp) then
          if (leshift(i)) then
            if (lgshift(i)) then
              if (nmptr.gt.0) then
                if (l14scale) then
                  write(iout,'(''harmonic k3 grad '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                    mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''harmonic k3 grad '',a5,1x,a4,2(1x,a9))')  &
                    mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                endif
              else
                if (l14scale) then
                  write(iout,'(''harmonic k3 grad '',a4,1x,f6.4,2(1x,a9))')  &
                    mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''harmonic k3 grad '',a4,2(1x,a9))')  &
                    mmword,(botyword(nbotyptr(j)),j=1,nboty)
                endif
              endif
            else
              if (nmptr.gt.0) then
                if (l14scale) then
                  write(iout,'(''harmonic k3 energy '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                    mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''harmonic k3 energy '',a5,1x,a4,2(1x,a9))')  &
                    mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                endif
              else
                if (l14scale) then
                  write(iout,'(''harmonic k3 energy '',a4,1x,f6.4,2(1x,a9))')  &
                    mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''harmonic k3 energy '',a4,2(1x,a9))')  &
                    mmword,(botyword(nbotyptr(j)),j=1,nboty)
                endif
              endif
            endif
          else
            if (nmptr.gt.0) then
              if (l14scale) then
                write(iout,'(''harmonic k3 '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                  mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''harmonic k3 '',a5,1x,a4,2(1x,a9))')  &
                  mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            else
              if (l14scale) then
                write(iout,'(''harmonic k3 '',a4,1x,f6.4,2(1x,a9))')  &
                  mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''harmonic k3 '',a4,2(1x,a9))')  &
                  mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            endif
          endif
          if (lfit) then
            ii = itmp(20*(i-1)+2)
            itmp(20*(i-1)+2) = itmp(20*(i-1)+3)
            itmp(20*(i-1)+3) = ii
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),3(g10.5,1x),f4.2,3i2)') &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(3,i),twopot(2,i),tpot(1,i),(itmp(20*(i-1)+j),j=1,3)
            else
              write(iout,'(2(a5,1x,a4,1x),3(g10.5,1x),f4.2,2(1x,f6.3),3i2)') &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(3,i),twopot(2,i),tpot(1,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,3)
            endif
          else
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),3(g10.5,1x),f4.2)') &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(3,i),twopot(2,i),tpot(1,i)
            else
              write(iout,'(2(a5,1x,a4,1x),3(g10.5,1x),f4.2,2(1x,f6.3))') &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(3,i),twopot(2,i),tpot(1,i),rpot2(i),rpot(i)
            endif
          endif
        elseif (twopot(4,i).ne.0.0_dp) then
          if (leshift(i)) then
            if (lgshift(i)) then
              if (nmptr.gt.0) then
                if (l14scale) then
                  write(iout,'(''harmonic k4 grad '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                    mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''harmonic k4 grad '',a5,1x,a4,2(1x,a9))')  &
                    mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                endif
              else
                if (l14scale) then
                  write(iout,'(''harmonic k4 grad '',a4,1x,f6.4,2(1x,a9))')  &
                    mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''harmonic k4 grad '',a4,2(1x,a9))')  &
                    mmword,(botyword(nbotyptr(j)),j=1,nboty)
                endif
              endif
            else
              if (nmptr.gt.0) then
                if (l14scale) then
                  write(iout,'(''harmonic k4 energy '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                    mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''harmonic k4 energy '',a5,1x,a4,2(1x,a9))')  &
                    mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                endif
              else
                if (l14scale) then
                  write(iout,'(''harmonic k4 energy '',a4,1x,f6.4,2(1x,a9))')  &
                    mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''harmonic k4 energy '',a4,2(1x,a9))')  &
                    mmword,(botyword(nbotyptr(j)),j=1,nboty)
                endif
              endif
            endif
          else
            if (nmptr.gt.0) then
              if (l14scale) then
                write(iout,'(''harmonic k4 '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                  mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''harmonic k4 '',a5,1x,a4,2(1x,a9))')  &
                  mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            else
              if (l14scale) then
                write(iout,'(''harmonic k4 '',a4,1x,f6.4,2(1x,a9))')  &
                  mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''harmonic k4 '',a4,2(1x,a9))')  &
                  mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            endif
          endif
          if (lfit) then
            ii = itmp(20*(i-1)+2)
            itmp(20*(i-1)+2) = itmp(20*(i-1)+4)
            itmp(20*(i-1)+4) = ii
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),3(g10.5,1x),f4.2,3i2)') lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(4,i), &
                twopot(2,i),tpot(1,i),itmp(20*(i-1)+1),itmp(20*(i-1)+2),itmp(20*(i-1)+4)
            else
              write(iout,'(2(a5,1x,a4,1x),3(g10.5,1x),f4.2,2(1x,f6.3),3i2)')lab1,ctmp(1),lab2,ctmp(2),twopot(1,i), &
                twopot(4,i),twopot(2,i),tpot(1,i),rpot2(i),rpot(i),itmp(20*(i-1)+1),itmp(20*(i-1)+2),itmp(20*(i-1)+4)
            endif
          else
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),3(g10.5,1x),f4.2)') &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(4,i),twopot(2,i),tpot(1,i)
            else
              write(iout,'(2(a5,1x,a4,1x),3(g10.5,1x),f4.2,2(1x,f6.3))') &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(4,i),twopot(2,i),tpot(1,i),rpot2(i),rpot(i)
            endif
          endif
        else
          if (leshift(i)) then
            if (lgshift(i)) then
              if (nmptr.gt.0) then
                if (l14scale) then
                  write(iout,'(''harmonic grad '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                    mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''harmonic grad '',a5,1x,a4,2(1x,a9))')  &
                    mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                endif
              else
                if (l14scale) then
                  write(iout,'(''harmonic grad '',a4,1x,f6.4,2(1x,a9))')  &
                    mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''harmonic grad '',a4,2(1x,a9))')  &
                    mmword,(botyword(nbotyptr(j)),j=1,nboty)
                endif
              endif
            else
              if (nmptr.gt.0) then
                if (l14scale) then
                  write(iout,'(''harmonic energy '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                    mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''harmonic energy '',a5,1x,a4,2(1x,a9))')  &
                    mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                endif
              else
                if (l14scale) then
                  write(iout,'(''harmonic energy '',a4,1x,f6.4,2(1x,a9))')  &
                    mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''harmonic energy '',a4,2(1x,a9))')  &
                    mmword,(botyword(nbotyptr(j)),j=1,nboty)
                endif
              endif
            endif
          else
            if (nmptr.gt.0) then
              if (l14scale) then
                write(iout,'(''harmonic '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                  mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''harmonic '',a5,1x,a4,2(1x,a9))')  &
                  mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            else
              if (l14scale) then
                write(iout,'(''harmonic '',a4,1x,f6.4,2(1x,a9))')  &
                  mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''harmonic '',a4,2(1x,a9))')  &
                  mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            endif
          endif
          if (lfit) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),3(g12.6,1x),2i2)') &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),tpot(1,i),(itmp(20*(i-1)+j),j=1,2)
            else
              write(iout,'(2(a5,1x,a4,1x),3(g12.6,1x),2(f6.3,1x),2i2)') &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i), &
                tpot(1,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,2)
            endif
          else
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),3(g12.6,1x))') &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),tpot(1,i)
            else
              write(iout,'(2(a5,1x,a4,1x),3(g12.6,1x),2(f6.3,1x))') &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),tpot(1,i),rpot2(i),rpot(i)
            endif
          endif
        endif
      elseif (nptype(i).eq.7) then
!
!  General potential
!
        mpt = int(tpot(1,i))
        npt = int(tpot(2,i))
        if (leshift(i)) then
          if (lgshift(i)) then
            if (nmptr.gt.0) then
              if (l14scale) then
                write(iout,'(''general '',a5,'' grad '',2i3,1x,a4,1x,f6.4,2(1x,a9))')  &
                  mword(nmptr),mpt,npt,mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''general '',a5,'' grad '',2i3,1x,a4,2(1x,a9))')  &
                  mword(nmptr),mpt,npt,mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            else
              if (l14scale) then
                write(iout,'(''general grad '',2i3,1x,a4,1x,f6.4,2(1x,a9))') &
                  mpt,npt,mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''general grad '',2i3,1x,a4,2(1x,a9))')  &
                  mpt,npt,mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            endif
          else
            if (nmptr.gt.0) then
              if (l14scale) then
                write(iout,'(''general '',a5,'' ener '',2i3,1x,a4,1x,f6.4,2(1x,a9))') &
                  mword(nmptr),mpt,npt,mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''general '',a5,'' ener '',2i3,1x,a4,2(1x,a9))')  &
                  mword(nmptr),mpt,npt,mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            else
              if (l14scale) then
                write(iout,'(''general ener '',2i3,1x,a4,1x,f6.4,2(1x,a9))')  &
                  mpt,npt,mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''general ener '',2i3,1x,a4,2(1x,a9))')  &
                  mpt,npt,mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            endif
          endif
        else
          if (nmptr.gt.0) then
            if (l14scale) then
              write(iout,'(''general '',a5,1x,2i3,1x,a4,1x,f6.4,2(1x,a9))')  &
                mword(nmptr),mpt,npt,mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
            else
              write(iout,'(''general '',a5,1x,2i3,1x,a4,2(1x,a9))')  &
                mword(nmptr),mpt,npt,mmword,(botyword(nbotyptr(j)),j=1,nboty)
            endif
          else
            if (l14scale) then
              write(iout,'(''general '',2i3,1x,a4,1x,f6.4,2(1x,a9))')  &
                mpt,npt,mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
            else
              write(iout,'(''general '',2i3,1x,a4,2(1x,a9))')  &
                mpt,npt,mmword,(botyword(nbotyptr(j)),j=1,nboty)
            endif
          endif
        endif
        if (lfit) then
          if (mmexc(i).eq.1) then
            write(iout,'(2(a5,1x,a4,1x),g14.8,1x,f8.6,1x,f8.4,3i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),(itmp(20*(i-1)+j),j=1,3)
          else
            write(iout,'(2(a5,1x,a4,1x),g14.8,1x,f8.6,1x,f8.4,2(1x,f6.3),3i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,3)
          endif
        else
          if (mmexc(i).eq.1) then
            write(iout,'(2(a5,1x,a4,1x),g14.8,1x,f8.6,1x,f8.4)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i)
          else
            write(iout,'(2(a5,1x,a4,1x),g14.8,1x,f8.6,1x,f8.4,2(1x,f6.3))') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),rpot2(i),rpot(i)
          endif
        endif
      elseif (nptype(i).eq.8) then
!
!  Spring potential
!
        write(iout,'(''spring'')')
        if (lfit) then
          if (twopot(2,i).ne.0.0_dp) then
            write(iout,'(a5,1x,2g14.8,2i2)') lab1,twopot(1,i),twopot(2,i),itmp(20*(i-1)+1),itmp(20*(i-1)+2)
          else
            write(iout,'(a5,1x,g14.8,i2)') lab1,twopot(1,i),itmp(20*(i-1)+1)
          endif
        else
          if (twopot(2,i).ne.0.0_dp) then
            write(iout,'(a5,1x,2g14.8)')lab1,twopot(1,i),twopot(2,i)
          else
            write(iout,'(a5,1x,g14.8)')lab1,twopot(1,i)
          endif
        endif
      elseif (nptype(i).eq.9) then
!
!  Coulomb subtraction potential
!
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''coulomb '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''coulomb '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''coulomb '',a4,1x,f6.4,2(1x,a9))')  &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''coulomb '',a4,2(1x,a9))')  &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          if (mmexc(i).eq.1) then
            write(iout,'(2(a5,1x,a4,1x),f7.4,i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(4,i),itmp(20*(i-1)+1)
          else
            write(iout,'(2(a5,1x,a4,1x),f7.4,2(f6.3,1x),i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(4,i),rpot2(i),rpot(i),itmp(20*(i-1)+1)
          endif
        else
          if (mmexc(i).eq.1) then
            write(iout,'(2(a5,1x,a4,1x),f7.4)')  &
              lab1,ctmp(1),lab2,ctmp(2),twopot(4,i)
          else
            write(iout,'(2(a5,1x,a4,1x),f7.4,2(f6.3,1x))') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(4,i),rpot2(i),rpot(i)
          endif
        endif
      elseif (nptype(i).eq.10) then
!
!  Four Range Buckingham
!
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''buck4 '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''buck4 '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''buck4'',1x,a4,1x,f6.4,2(1x,a9))') &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''buck4'',1x,a4,2(1x,a9))') &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          write(iout,'(2(a5,1x,a4,1x),f10.4,1x,f8.6,1x,f7.3,'' &'')') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i)
          if (mmexc(i).eq.1) then
            write(iout,'(3(f6.3,1x),4i2)') tpot(1,i),twopot(4,i),tpot(2,i),(itmp(20*(i-1)+j),j=1,4)
          else
            write(iout,'(5(f6.3,1x),4i2)') rpot2(i),tpot(1,i),twopot(4,i),tpot(2,i),rpot(i),(itmp(20*(i-1)+j),j=1,4)
          endif
        else
          write(iout,'(2(a5,1x,a4,1x),f10.4,1x,f8.6,1x,f7.3,'' &'')')lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i)
          if (mmexc(i).eq.1) then
            write(iout,'(3(f6.3,1x))') tpot(1,i),twopot(4,i),tpot(2,i)
          else
            write(iout,'(5(f6.3,1x))') rpot2(i),tpot(1,i),twopot(4,i),tpot(2,i),rpot(i)
          endif
        endif
      elseif (nptype(i).eq.11) then
!
!  Spline
!
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''spline '',a5,1x,a7,1x,a4,1x,f6.4,2(1x,a9))') &
              mword(nmptr),spltype(nsplty(i)),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''spline '',a5,1x,a7,1x,a4,2(1x,a9))')  &
              mword(nmptr),spltype(nsplty(i)),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''spline '',a7,1x,a4,1x,f6.4,2(1x,a9))') &
              spltype(nsplty(i)),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''spline '',a7,1x,a4,2(1x,a9))') &
              spltype(nsplty(i)),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          if (mmexc(i).eq.1) then
            write(iout,'(2(a5,1x,a4,1x),g14.6,i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),itmp(20*(i-1)+1)
          else
            write(iout,'(2(a5,1x,a4,1x),g14.6,2(1x,f6.3),i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),rpot2(i),rpot(i),itmp(20*(i-1)+1)
          endif
        else
          if (mmexc(i).eq.1) then
            write(iout,'(2(a5,1x,a4,1x),g14.6)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i)
          else
            write(iout,'(2(a5,1x,a4,1x),g14.6,2(1x,f6.3))') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),rpot2(i),rpot(i)
          endif
        endif
        do j = 1,nsplpt(i)
          write(iout,'(g20.12,2x,g14.8)') splf(j,i),splr(j,i)
        enddo
      elseif (nptype(i).eq.12) then
!
!  Lennard-Jones - epsilon/sigma format : sigma = r at E = zero
!
        im = nint(tpot(1,i))
        in = nint(tpot(2,i))
        if (lcombine(i)) then
          if (nmptr.gt.0) then
            if (l14scale) then
              if (ncombipower(i).eq.6) then
                write(iout,'(''lenn epsilon zero combine '',i2,1x,i2,1x,a5,1x,a4,1x,f6.4,2(1x,a9))') &
                  im,in,mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''lenn epsilon zero geometric'',i2,1x,i2,1x,a5,1x,a4,1x,f6.4,2(1x,a9))') &
                  im,in,mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              endif
            else
              if (ncombipower(i).eq.6) then
                write(iout,'(''lenn epsilon zero combine '',i2,1x,i2,1x,a5,1x,a4,2(1x,a9))') &
                  im,in,mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''lenn epsilon zero geometric '',i2,1x,i2,1x,a5,1x,a4,2(1x,a9))') &
                  im,in,mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            endif
          else
            if (l14scale) then
              if (ncombipower(i).eq.6) then
                write(iout,'(''lenn epsilon zero combine '',i2,1x,i2,1x,a4,1x,f6.4,2(1x,a9))') &
                  im,in,mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''lenn epsilon zero geometric '',i2,1x,i2,1x,a4,1x,f6.4,2(1x,a9))') &
                  im,in,mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              endif
            else
              if (ncombipower(i).eq.6) then
                write(iout,'(''lenn epsilon zero combine '',i2,1x,i2,1x,a4,2(1x,a9))') &
                  im,in,mmword,(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''lenn epsilon zero geometric '',i2,1x,i2,1x,a4,2(1x,a9))') &
                  im,in,mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            endif
          endif
          write(iout,'(2(a5,1x,a4,1x),2(f6.3,1x))') lab1,ctmp(1),lab2,ctmp(2),rpot2(i),rpot(i)
        else
          if (nmptr.gt.0) then
            if (l14scale) then
              write(iout,'(''lenn epsilon zero '',i2,1x,i2,1x,a5,1x,a4,1x,f6.4,2(1x,a9))') &
                im,in,mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
            else
              write(iout,'(''lenn epsilon zero '',i2,1x,i2,1x,a5,1x,a4,2(1x,a9))') &
                im,in,mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
            endif
          else
            if (l14scale) then
              write(iout,'(''lenn epsilon zero '',i2,1x,i2,1x,a4,1x,f6.4,2(1x,a9))') &
                im,in,mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
            else
              write(iout,'(''lenn epsilon zero '',i2,1x,i2,1x,a4,2(1x,a9))') &
                im,in,mmword,(botyword(nbotyptr(j)),j=1,nboty)
            endif
          endif
          if (lfit) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),2(g14.8,1x),2i2)') &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),(itmp(20*(i-1)+j),j=1,2)
            else
              write(iout,'(2(a5,1x,a4,1x),2(g14.8,1x),2(f6.3,1x),2i2)')  &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,2)
            endif
          else
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),2(g14.8,1x))') lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i)
            else
              write(iout,'(2(a5,1x,a4,1x),2(g14.8,1x),2(f6.3,1x))') &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),rpot2(i),rpot(i)
            endif
          endif
        endif
      elseif (nptype(i).eq.13) then
!
!  Lennard-Jones - epsilon/sigma format : sigma = minimum r
!
        im = nint(tpot(1,i))
        in = nint(tpot(2,i))
        lnoninteger = (abs(tpot(1,i)-dble(im))+abs(tpot(2,i)-dble(in)).gt.1.0d-6)
        if (lcombine(i)) then
          if (nmptr.gt.0) then
            if (l14scale) then
              if (lnoninteger) then
                if (ncombipower(i).eq.6) then
                  write(iout,'(''lenn epsilon combine '',f7.4,1x,f7.4,1x,a5,1x,a4,1x,f6.4,2(1x,a9))') &
                    tpot(1,i),tpot(2,i),mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''lenn epsilon geometric '',f7.4,1x,f7.4,1x,a5,1x,a4,1x,f6.4,2(1x,a9))') &
                    tpot(1,i),tpot(2,i),mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                endif
              else
                if (ncombipower(i).eq.6) then
                  write(iout,'(''lenn epsilon combine '',i2,1x,i2,1x,a5,1x,a4,1x,f6.4,2(1x,a9))') &
                    im,in,mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''lenn epsilon geometric '',i2,1x,i2,1x,a5,1x,a4,1x,f6.4,2(1x,a9))') &
                    im,in,mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                endif
              endif
            else
              if (lnoninteger) then
                if (ncombipower(i).eq.6) then
                  write(iout,'(''lenn epsilon combine '',f7.4,1x,f7.4,1x,a5,1x,a4,2(1x,a9))')  &
                    tpot(1,i),tpot(2,i),mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''lenn epsilon geometric '',f7.4,1x,f7.4,1x,a5,1x,a4,2(1x,a9))')  &
                    tpot(1,i),tpot(2,i),mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                endif
              else
                if (ncombipower(i).eq.6) then
                  write(iout,'(''lenn epsilon combine '',i2,1x,i2,1x,a5,1x,a4,2(1x,a9))')  &
                    im,in,mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''lenn epsilon geometric '',i2,1x,i2,1x,a5,1x,a4,2(1x,a9))')  &
                    im,in,mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                endif
              endif
            endif
          else
            if (l14scale) then
              if (lnoninteger) then
                if (ncombipower(i).eq.6) then
                  write(iout,'(''lenn epsilon combine '',f7.4,1x,f7.4,1x,a4,1x,f6.4,2(1x,a9))')  &
                    tpot(1,i),tpot(2,i),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''lenn epsilon geometric '',f7.4,1x,f7.4,1x,a4,1x,f6.4,2(1x,a9))')  &
                    tpot(1,i),tpot(2,i),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                endif
              else
                if (ncombipower(i).eq.6) then
                  write(iout,'(''lenn epsilon combine '',i2,1x,i2,1x,a4,1x,f6.4,2(1x,a9))')  &
                    im,in,mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''lenn epsilon geometric '',i2,1x,i2,1x,a4,1x,f6.4,2(1x,a9))')  &
                    im,in,mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
                endif
              endif
            else
              if (lnoninteger) then
                if (ncombipower(i).eq.6) then
                  write(iout,'(''lenn epsilon combine '',f7.4,1x,f7.4,1x,a4,2(1x,a9))')  &
                    tpot(1,i),tpot(2,i),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''lenn epsilon geometric '',f7.4,1x,f7.4,1x,a4,2(1x,a9))')  &
                    tpot(1,i),tpot(2,i),mmword,(botyword(nbotyptr(j)),j=1,nboty)
                endif
              else
                if (ncombipower(i).eq.6) then
                  write(iout,'(''lenn epsilon combine '',i2,1x,i2,1x,a4,2(1x,a9))')  &
                    im,in,mmword,(botyword(nbotyptr(j)),j=1,nboty)
                else
                  write(iout,'(''lenn epsilon geometric '',i2,1x,i2,1x,a4,2(1x,a9))')  &
                    im,in,mmword,(botyword(nbotyptr(j)),j=1,nboty)
                endif
              endif
            endif
          endif
          if (mmexc(i).eq.1) then
            write(iout,'(2(a5,1x,a4,1x))') lab1,ctmp(1),lab2,ctmp(2)
          else
            write(iout,'(2(a5,1x,a4,1x),2(f6.3,1x))') lab1,ctmp(1),lab2,ctmp(2),rpot2(i),rpot(i)
          endif
        else
          if (nmptr.gt.0) then
            if (l14scale) then
              if (lnoninteger) then
                write(iout,'(''lenn epsilon '',f7.4,1x,f7.4,1x,a5,1x,a4,1x,f6.4,2(1x,a9))') &
                  tpot(1,i),tpot(2,i),mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''lenn epsilon '',i2,1x,i2,1x,a5,1x,a4,1x,f6.4,2(1x,a9))') &
                  im,in,mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              endif
            else
              if (lnoninteger) then
                write(iout,'(''lenn epsilon '',f7.4,1x,f7.4,1x,a5,1x,a4,2(1x,a9))') &
                  tpot(1,i),tpot(2,i),mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''lenn epsilon '',i2,1x,i2,1x,a5,1x,a4,2(1x,a9))') &
                  im,in,mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            endif
          else
            if (l14scale) then
              if (lnoninteger) then
                write(iout,'(''lenn epsilon '',f7.4,1x,f7.4,1x,a4,1x,f6.4)')  &
                  tpot(1,i),tpot(2,i),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''lenn epsilon '',i2,1x,i2,1x,a4,1x,f6.4)')  &
                  im,in,mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              endif
            else
              if (lnoninteger) then
                write(iout,'(''lenn epsilon '',f7.4,1x,f7.4,1x,a4)')  &
                  tpot(1,i),tpot(2,i),mmword,(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''lenn epsilon '',i2,1x,i2,1x,a4)')  &
                  im,in,mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            endif
          endif
          if (lfit) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),2(g14.6,1x),2i2)') &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),(itmp(20*(i-1)+j),j=1,2)
            else
              write(iout,'(2(a5,1x,a4,1x),2(g14.6,1x),2(f6.3,1x),2i2)')  &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,2)
            endif
          else
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),2(g14.6,1x))')  &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i)
            else
              write(iout,'(2(a5,1x,a4,1x),2(g14.6,1x),2(f6.3,1x))') &
                lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),rpot2(i),rpot(i)
            endif
          endif
        endif
      elseif (nptype(i).eq.14) then
!
!  Breathing shell model potential
!
        write(iout,'(''bsm'')')
        if (lfit) then
          if (twopot(2,i).ne.0.0_dp) then
            write(iout,'(a5,1x,a4,1x,2g14.6,2i2)') lab1,ctmp(1), &
              twopot(1,i),twopot(2,i),itmp(20*(i-1)+1),itmp(20*(i-1)+2)
          else
            write(iout,'(a5,1x,a4,1x,g14.6,i2)') lab1,ctmp(1),twopot(1,i),itmp(20*(i-1)+1)
          endif
        else
          if (twopot(2,i).ne.0.0_dp) then
            write(iout,'(a5,1x,a4,1x,2g14.6)') lab1,ctmp(1),twopot(1,i),twopot(2,i)
          else
            write(iout,'(a5,1x,a4,1x,g14.6)') lab1,ctmp(1),twopot(1,i)
          endif
        endif
      elseif (nptype(i).eq.15) then
!
!  Stillinger-Weber 2 body
!
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''sw2 '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''sw2 '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''sw2'',1x,a4,1x,f6.4,2(1x,a9))') &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''sw2'',1x,a4,2(1x,a9))') &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f8.6,1x,f10.5,2(1x,f6.3),3i2)') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,3)
        else
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f8.6,1x,f10.5,2(1x,f6.3))') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),rpot2(i),rpot(i)
        endif
      elseif (nptype(i).eq.16) then
!
!  Inverse Gaussian
!
        if (leshift(i)) then
          if (lgshift(i)) then
            if (nmptr.gt.0) then
              if (l14scale) then
                write(iout,'(''igauss grad '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                  mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''igauss grad '',a5,1x,a4,2(1x,a9))')  &
                  mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            else
              if (l14scale) then
                write(iout,'(''igauss grad '',a4,1x,f6.4,2(1x,a9))')  &
                  mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''igauss grad '',a4,2(1x,a9))') &
                  mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            endif
          else
            if (nmptr.gt.0) then
              if (l14scale) then
                write(iout,'(''igauss energy '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                  mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''igauss energy '',a5,1x,a4,2(1x,a9))')  &
                  mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            else
              if (l14scale) then
                write(iout,'(''igauss energy '',a4,1x,f6.4,2(1x,a9))')  &
                  mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''igauss energy '',a4,2(1x,a9))')  &
                  mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            endif
          endif
        else
          if (nmptr.gt.0) then
            if (l14scale) then
              write(iout,'(''igauss '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
            else
              write(iout,'(''igauss '',a5,1x,a4,2(1x,a9))')  &
                mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
            endif
          else
            if (l14scale) then
              write(iout,'(''igauss'',1x,a4,1x,f6.4,2(1x,a9))')  &
                mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
            else
              write(iout,'(''igauss'',1x,a4,2(1x,a9))')  &
                mmword,(botyword(nbotyptr(j)),j=1,nboty)
            endif
          endif
        endif
        if (lfit) then
          if (mmexc(i).eq.1) then
            write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f8.6,1x,f10.5,3i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),(itmp(20*(i-1)+j),j=1,3)
          else
            write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f8.6,1x,f10.5,2(1x,f6.3),3i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,3)
          endif
        else
          if (mmexc(i).eq.1) then
            write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f8.6,1x,f10.5)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i)
          else
            write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f8.6,1x,f10.5,2(1x,f6.3))') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),rpot2(i),rpot(i)
          endif
        endif
      elseif (nptype(i).eq.17.or.nptype(i).eq.31) then
!
!  Breathing shell model exponential potential
!
        if (nptype(i).eq.17) then
          write(iout,'(''bsm exponential'')')
        else
          write(iout,'(''bsm single_exponential'')')
        endif
        if (lfit) then
          write(iout,'(a5,1x,3f14.6,3i2)') lab1,twopot(1,i),twopot(2,i),twopot(3,i),(itmp(20*(i-1)+j),j=1,3)
        else
          write(iout,'(a5,1x,3f14.6)') lab1,twopot(1,i),twopot(2,i),twopot(3,i)
        endif
      elseif (nptype(i).eq.18) then
!
!  Damped dispersion
!
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''damped_dispersion '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''damped_dispersion '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''damped_dispersion'',1x,a4,1x,f6.4,2(1x,a9))')  &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''damped_dispersion'',1x,a4,2(1x,a9))') &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          write(iout,'(2(a5,1x,a4,1x),3(f12.6,1x),''&'')') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),tpot(1,i)
          if (mmexc(i).eq.1) then
            write(iout,'(3(f9.5,1x),6i2)') twopot(3,i),twopot(4,i),tpot(2,i),itmp(20*(i-1)+1),itmp(20*(i-1)+2), &
              itmp(20*(i-1)+10),itmp(20*(i-1)+3),itmp(20*(i-1)+4),itmp(20*(i-1)+11)
          else
            write(iout,'(3(f9.5,1x),2(f7.3,1x),6i2)') &
              twopot(3,i),twopot(4,i),tpot(2,i),rpot2(i),rpot(i), &
              itmp(20*(i-1)+1),itmp(20*(i-1)+2),itmp(20*(i-1)+10), &
              itmp(20*(i-1)+3),itmp(20*(i-1)+4),itmp(20*(i-1)+11)
          endif
        else
          write(iout,'(2(a5,1x,a4,1x),3(f12.6,1x),''&'')') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),tpot(1,i)
          if (mmexc(i).eq.1) then
            write(iout,'(3(f9.5,1x))') twopot(3,i),twopot(4,i),tpot(2,i)
          else
            write(iout,'(3(f9.5,1x),2(f7.3,1x))') twopot(3,i),twopot(4,i),tpot(2,i),rpot2(i),rpot(i)
          endif
        endif
      elseif (nptype(i).eq.19) then
!
!  Many-body potential
!
        write(iout,'(''manybody'')')
        write(iout,'(2(a5,1x,a4,1x),2(f6.3,1x))') &
          lab1,ctmp(1),lab2,ctmp(2),rpot2(i),rpot(i)
      elseif (nptype(i).eq.20) then
!
!  Rydberg / Rose-Smith-Guinea-Ferrante
!
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''rydberg '',a5,1x,a4,1x,f6.4)') mword(nmptr),mmword,scale14(i)
          else
            write(iout,'(''rydberg '',a5,1x,a4)') mword(nmptr),mmword
          endif
        else
          if (l14scale) then
            write(iout,'(''rydberg'',1x,a4,1x,f6.4)') mmword,scale14(i)
          else
            write(iout,'(''rydberg'',1x,a4)') mmword
          endif
        endif
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f12.6,1x,f10.6,1x,f10.5,2(1x,f6.3),3i2)')  &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,3)
        else
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f12.6,1x,f10.6,1x,f10.5,2(1x,f6.3))') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),rpot2(i),rpot(i)
        endif
      elseif (nptype(i).eq.22) then
!
!  Coulomb taper potential
!
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''qtaper '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''qtaper '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''qtaper'',1x,a4,1x,f6.4,2(1x,a9))')  &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''qtaper'',1x,a4,2(1x,a9))')  &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          if (mmexc(i).eq.1) then
            write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,g18.8,1x,i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),itmp(20*(i-1)+1)
          else
            write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,g18.8,1x,f10.5,i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),rpot(i),itmp(20*(i-1)+1)
          endif
        else
          if (mmexc(i).eq.1) then
            write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,g18.8,1x)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i)
          else
            write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,g18.8,1x,f10.5)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),rpot(i)
          endif
        endif
      elseif (nptype(i).eq.23) then
!
!  Polynomial
!
        norder = nint(twopot(4,i))
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''polynomial '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''polynomial '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''polynomial'',1x,a4,1x,f6.4,2(1x,a9))')  &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''polynomial'',1x,a4,2(1x,a9))')  &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        write(iout,'(i2)') norder - 1
        if (lfit) then
          if (norder.eq.2) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),2(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,2)
              write(iout,'(f6.3,1x,2i2)') twopot(1,i),(itmp(20*(i-1)+j),j=10,11)
            else
              write(iout,'(2(a5,1x,a4,1x),2(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,2)
              write(iout,'(3(f6.3,1x),2i2)') twopot(1,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=10,11)
            endif
          elseif (norder.eq.3) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),3(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,3)
              write(iout,'(f6.3,1x,3i2)') twopot(1,i),(itmp(20*(i-1)+j),j=10,12)
            else
              write(iout,'(2(a5,1x,a4,1x),3(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,3)
              write(iout,'(3(f6.3,1x),3i2)') twopot(1,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=10,12)
            endif
          elseif (norder.eq.4) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(f6.3,1x,4i2)') twopot(1,i),(itmp(20*(i-1)+j),j=10,13)
            else
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(3(f6.3,1x),4i2)') twopot(1,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=10,13)
            endif
          elseif (norder.eq.5) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(f12.6,1x,f6.3,1x,5i2)') tpot(5,i),twopot(1,i),(itmp(20*(i-1)+j),j=10,14)
            else
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(f12.6,1x,3(f6.3,1x),5i2)') tpot(5,i),twopot(1,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=10,14)
            endif
          elseif (norder.eq.6) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(2(f12.6,1x),f6.3,1x,6i2)') (tpot(j,i),j=5,6),twopot(1,i),(itmp(20*(i-1)+j),j=10,15)
            else
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(2(f12.6,1x),3(f6.3,1x),6i2)') (tpot(j,i),j=5,6),twopot(1,i),rpot2(i),rpot(i), &
                (itmp(20*(i-1)+j),j=10,15)
            endif
          elseif (norder.eq.7) then
            write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
            write(iout,'(2x,3(f12.6,1x),''&'')') (tpot(j,i),j=5,7)
            if (mmexc(i).eq.1) then
              write(iout,'(2x,f6.3,1x,7i2)') twopot(1,i),(itmp(10*(i-1)+j),j=10,16)
            else
              write(iout,'(2x,3(f6.3,1x),7i2)') twopot(1,i),rpot2(i),rpot(i),(itmp(10*(i-1)+j),j=10,16)
            endif
          elseif (norder.eq.8) then
            write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
            write(iout,'(2x,4(f12.6,1x),''&'')') (tpot(j,i),j=5,8)
            if (mmexc(i).eq.1) then
              write(iout,'(2x,f6.3,1x,8i2)') twopot(1,i),(itmp(10*(i-1)+j),j=10,17)
            else
              write(iout,'(2x,3(f6.3,1x),8i2)') twopot(1,i),rpot2(i),rpot(i),(itmp(10*(i-1)+j),j=10,17)
            endif
          elseif (norder.eq.9) then
            write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
            write(iout,'(2x,5(f12.6,1x),''&'')') (tpot(j,i),j=5,9)
            if (mmexc(i).eq.1) then
              write(iout,'(2x,f6.3,1x,9i2)') twopot(1,i),(itmp(10*(i-1)+j),j=10,18)
            else
              write(iout,'(2x,3(f6.3,1x),9i2)') twopot(1,i),rpot2(i),rpot(i),(itmp(10*(i-1)+j),j=10,18)
            endif
          endif
        else
          if (norder.eq.2) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),2(f12.6,1x))') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,2),twopot(1,i)
            else
              write(iout,'(2(a5,1x,a4,1x),2(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,2)
              write(iout,'(2(f6.3,1x))') twopot(1,i),rpot2(i),rpot(i)
            endif
          elseif (norder.eq.3) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),3(f12.6,1x))') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,3)
            else
              write(iout,'(2(a5,1x,a4,1x),3(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,3)
              write(iout,'(2(f6.3,1x))') twopot(1,i),rpot2(i),rpot(i)
            endif
          elseif (norder.eq.4) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(f6.3)') twopot(1,i)
            else
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(3(f6.3,1x))') twopot(1,i),rpot2(i),rpot(i)
            endif
          elseif (norder.eq.5) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(f12.6,1x,f6.3)') tpot(5,i),twopot(1,i)
            else
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(f12.6,1x,3(f6.3,1x))') tpot(5,i),twopot(1,i),rpot2(i),rpot(i)
            endif
          elseif (norder.eq.6) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(2(f12.6,1x))') (tpot(j,i),j=5,6),twopot(1,i)
            else
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(2(f12.6,1x),3(f6.3,1x))') (tpot(j,i),j=5,6),twopot(1,i),rpot2(i),rpot(i)
            endif
          elseif (norder.eq.7) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(3(f12.6,1x),f6.3)') (tpot(j,i),j=5,7),twopot(1,i)
            else
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(3(f12.6,1x),3(f6.3,1x))') (tpot(j,i),j=5,7),twopot(1,i),rpot2(i),rpot(i)
            endif
          elseif (norder.eq.8) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(4(f12.6,1x),f6.3)') (tpot(j,i),j=5,8),twopot(1,i)
            else
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(4(f11.5,1x),3(f6.3,1x))') (tpot(j,i),j=5,8),twopot(1,i),rpot2(i),rpot(i)
            endif
          elseif (norder.eq.9) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(5(f11.5,1x),f6.3)') (tpot(j,i),j=5,9),twopot(1,i)
            else
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(5(f12.6,1x),''&'')') (tpot(j,i),j=5,9)
              write(iout,'(3(f6.3,1x))') twopot(1,i),rpot2(i),rpot(i)
            endif
          endif
        endif
      elseif (nptype(i).eq.21) then
!
!  Lennard-Jones - ESFF combination rules
!
        im = nint(tpot(1,i))
        in = nint(tpot(2,i))
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''lennard esff '',i2,1x,i2,1x,a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              im,in,mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''lennard esff '',i2,1x,i2,1x,a5,1x,a4,2(1x,a9))')  &
              im,in,mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''lennard esff '',i2,1x,i2,1x,a4,1x,f6.4,2(1x,a9))')  &
              im,in,mmword,(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''lennard esff '',i2,1x,i2,1x,a4,2(1x,a9))')  &
              im,in,mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (mmexc(i).eq.1) then
          write(iout,'(2(a5,1x,a4,1x))') lab1,ctmp(1),lab2,ctmp(2)
        else
          write(iout,'(2(a5,1x,a4,1x),2(g12.6,1x))') lab1,ctmp(1),lab2,ctmp(2),rpot2(i),rpot(i)
        endif
      elseif (nptype(i).eq.24) then
!
!  Coulomb erfc potential
!
        if (lgshift(i)) then
          if (nmptr.gt.0) then
            write(iout,'(''qerfc grad '',a5,1x,a4,2(1x,a9))') &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''qerfc grad '',1x,a4,2(1x,a9))') &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        elseif (leshift(i)) then
          if (nmptr.gt.0) then
            write(iout,'(''qerfc energy '',a5,1x,a4,2(1x,a9))') &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''qerfc energy '',1x,a4,2(1x,a9))') &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (nmptr.gt.0) then
            write(iout,'(''qerfc '',a5,1x,a4,2(1x,a9))') &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''qerfc'',1x,a4,2(1x,a9))') &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          if (mmexc(i).eq.1) then
            write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,g18.8,1x,i2)') lab1,ctmp(1),lab2,ctmp(2),twopot(1,i), &
              itmp(20*(i-1)+1)
          else
            write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,g18.8,1x,f10.5,i2)') lab1,ctmp(1),lab2,ctmp(2), &
              twopot(1,i),rpot(i),itmp(20*(i-1)+1)
          endif
        else
          if (mmexc(i).eq.1) then
            write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,g18.8,1x)') lab1,ctmp(1),lab2,ctmp(2),twopot(1,i)
          else
            write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,g18.8,1x,f10.5)') lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),rpot(i)
          endif
        endif
      elseif (nptype(i).eq.25) then
!
!  Covalent-Exponential
!
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''covexp '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''covexp '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''covexp'',1x,a4,1x,f6.4,2(1x,a9))')  &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''covexp'',1x,a4,2(1x,a9))')  &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          if (mmexc(i).eq.1) then
            write(iout,'(2(a5,1x,a4,1x),g13.8,1x,g10.5,1x,f8.5,1x,3i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),(itmp(20*(i-1)+j),j=1,3)
          else
            write(iout,'(2(a5,1x,a4,1x),g13.8,1x,g10.5,1x,f8.5,1x,2(f6.3,1x),3i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,3)
          endif
        else
          if (mmexc(i).eq.1) then
            write(iout,'(2(a5,1x,a4,1x),g13.8,1x,g10.5,1x,f8.5)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i)
          else
            write(iout,'(2(a5,1x,a4,1x),g13.8,1x,g10.5,1x,f8.5,2(1x,f6.3))') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),rpot2(i),rpot(i)
          endif
        endif
      elseif (nptype(i).eq.26) then
!
!  Fermi-Dirac
!
        if (lgshift(i)) then
          if (nmptr.gt.0) then
            if (l14scale) then
              write(iout,'(''fermi-dirac grad '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
            else
              write(iout,'(''fermi-dirac grad '',a5,1x,a4,2(1x,a9))')  &
                mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
            endif
          else
            if (l14scale) then
              write(iout,'(''fermi-dirac grad'',1x,a4,1x,f6.4,2(1x,a9))')  &
                mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
            else
              write(iout,'(''fermi-dirac grad'',1x,a4,2(1x,a9))')  &
                mmword,(botyword(nbotyptr(j)),j=1,nboty)
            endif
          endif
        elseif (leshift(i)) then
          if (nmptr.gt.0) then
            if (l14scale) then
              write(iout,'(''fermi-dirac energy '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
            else
              write(iout,'(''fermi-dirac energy '',a5,1x,a4,2(1x,a9))')  &
                mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
            endif
          else
            if (l14scale) then
              write(iout,'(''fermi-dirac energy'',1x,a4,1x,f6.4,2(1x,a9))')  &
                mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
            else
              write(iout,'(''fermi-dirac energy'',1x,a4,2(1x,a9))')  &
                mmword,(botyword(nbotyptr(j)),j=1,nboty)
            endif
          endif
        else
          if (nmptr.gt.0) then
            if (l14scale) then
              write(iout,'(''fermi-dirac '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
            else
              write(iout,'(''fermi-dirac '',a5,1x,a4,2(1x,a9))')  &
                mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
            endif
          else
            if (l14scale) then
              write(iout,'(''fermi-dirac'',1x,a4,1x,f6.4,2(1x,a9))')  &
                mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
            else
              write(iout,'(''fermi-dirac'',1x,a4,2(1x,a9))')  &
                mmword,(botyword(nbotyptr(j)),j=1,nboty)
            endif
          endif
        endif
        if (lfit) then
          if (mmexc(i).eq.1) then
            write(iout,'(2(a5,1x,a4,1x),f13.6,1x,g10.5,1x,f8.5,2x,3i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),(itmp(20*(i-1)+j),j=1,3)
          else
            write(iout,'(2(a5,1x,a4,1x),f13.6,1x,g10.5,1x,f8.5,1x,2(1x,f6.3),1x,3i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,3)
          endif
        else
          if (mmexc(i).eq.1) then
            write(iout,'(2(a5,1x,a4,1x),f13.6,1x,g10.5,1x,f8.5,1x)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i)
          else
            write(iout,'(2(a5,1x,a4,1x),f13.6,1x,g10.5,1x,f8.5,1x,2(1x,f6.3))') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),rpot2(i),rpot(i)
          endif
        endif
      elseif (nptype(i).eq.27) then
!
!  Lennard-Jones shifted form
!
        im = nint(tpot(1,i))
        in = nint(tpot(2,i))
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''ljbuffered '',i2,1x,i2,1x,a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              im,in,mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''ljbuffered '',i2,1x,i2,1x,a5,1x,a4,2(1x,a9))')  &
              im,in,mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''ljbuffered '',i2,1x,i2,1x,a4,1x,f6.4,2(1x,a9))')  &
              im,in,mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''ljbuffered '',i2,1x,i2,1x,a4,2(1x,a9))')  &
              im,in,mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          if (mmexc(i).eq.1) then
            write(iout,'(2(a5,1x,a4,1x),2(g16.8,1x),f10.6,1x,3i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),(itmp(20*(i-1)+j),j=1,3)
          else
            write(iout,'(2(a5,1x,a4,1x),2(g16.8,1x),f10.6,'' &'')') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i)
            write(iout,'(22x,2(f6.3,1x),3i2)') rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,3)
          endif
        else
          if (mmexc(i).eq.1) then
            write(iout,'(2(a5,1x,a4,1x),2(g16.8,1x),f10.6)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i)
          else
            write(iout,'(2(a5,1x,a4,1x),2(g16.8,1x),f10.6,1x,2(f6.3,1x))') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),rpot2(i),rpot(i)
          endif
        endif
      elseif (nptype(i).eq.28.or.nptype(i).eq.29) then
!
!  Squared Harmonic
!
        if (leshift(i)) then
          if (lgshift(i)) then
            if (nmptr.gt.0) then
              if (l14scale) then
                write(iout,'(''squaredharmonic grad '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                  mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''squaredharmonic grad '',a5,1x,a4,2(1x,a9))')  &
                  mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            else
              if (l14scale) then
                write(iout,'(''squaredharmonic grad '',a4,1x,f6.4,2(1x,a9))')  &
                  mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''squaredharmonic grad '',a4,2(1x,a9))')  &
                  mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            endif
          else
            if (nmptr.gt.0) then
              if (l14scale) then
                write(iout,'(''squaredharmonic energy '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                  mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''squaredharmonic energy '',a5,1x,a4,2(1x,a9))')  &
                  mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            else
              if (l14scale) then
                write(iout,'(''squaredharmonic energy '',a4,1x,f6.4,2(1x,a9))')  &
                  mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
              else
                write(iout,'(''squaredharmonic energy '',a4,2(1x,a9))')  &
                  mmword,(botyword(nbotyptr(j)),j=1,nboty)
              endif
            endif
          endif
        else
          if (nmptr.gt.0) then
            if (l14scale) then
              write(iout,'(''squaredharmonic '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
            else
              write(iout,'(''squaredharmonic '',a5,1x,a4,2(1x,a9))')  &
                mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
            endif
          else
            if (l14scale) then
              write(iout,'(''squaredharmonic '',a4,1x,f6.4,2(1x,a9))')  &
                mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
            else
              write(iout,'(''squaredharmonic '',a4,2(1x,a9))')  &
                mmword,(botyword(nbotyptr(j)),j=1,nboty)
            endif
          endif
        endif
        if (lfit) then
          if (mmexc(i).eq.1) then
            write(iout,'(2(a5,1x,a4,1x),3(g12.6,1x),2i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),tpot(1,i),(itmp(20*(i-1)+j),j=1,2)
          else
            write(iout,'(2(a5,1x,a4,1x),3(g12.6,1x),2(f6.3,1x),2i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i), &
              tpot(1,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,2)
          endif
        else
          if (mmexc(i).eq.1) then
            write(iout,'(2(a5,1x,a4,1x),3(g12.6,1x))') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),tpot(1,i)
          else
            write(iout,'(2(a5,1x,a4,1x),3(g12.6,1x),2(f6.3,1x))') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),tpot(1,i),rpot2(i),rpot(i)
          endif
        endif
      elseif (nptype(i).eq.30) then
!
!  Tsuneyuki potential
!
        if (nmptr.gt.0) then
          if (l14scale) then
            if (nint(tpot(1,i)).eq.2) then
              write(iout,'(''tsuneyuki form2 '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
            else
              write(iout,'(''tsuneyuki '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
                mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
            endif
          else
            if (nint(tpot(1,i)).eq.2) then
              write(iout,'(''tsuneyuki form2 '',a5,1x,a4,2(1x,a9))')  &
                mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
            else
              write(iout,'(''tsuneyuki '',a5,1x,a4,2(1x,a9))')  &
                mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
            endif
          endif
        else
          if (l14scale) then
            if (nint(tpot(1,i)).eq.2) then
              write(iout,'(''tsuneyuki form2'',1x,a4,1x,f6.4,2(1x,a9))')  &
                mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
            else
              write(iout,'(''tsuneyuki'',1x,a4,1x,f6.4,2(1x,a9))')  &
                mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
            endif
          else
            if (nint(tpot(1,i)).eq.2) then
              write(iout,'(''tsuneyuki form2'',1x,a4,2(1x,a9))')  &
                mmword,(botyword(nbotyptr(j)),j=1,nboty)
            else
              write(iout,'(''tsuneyuki'',1x,a4,2(1x,a9))')  &
                mmword,(botyword(nbotyptr(j)),j=1,nboty)
            endif
          endif
        endif
        if (lfit) then
          if (mmexc(i).eq.1) then
            write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,2(f8.4,1x),f10.6,1x,i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),itmp(20*(i-1)+1)
          else
            write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,2(f8.4,1x),f10.6,2(1x,f10.5),i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),rpot2(i),rpot(i),itmp(20*(i-1)+1)
          endif
        else 
          if (mmexc(i).eq.1) then
            write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,2(f8.4,1x),f10.6,1x)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i)
          else
            write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,2(f8.4,1x),f10.6,2(1x,f10.5))') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),rpot2(i),rpot(i)
          endif
        endif
      elseif (nptype(i).eq.32) then
!  
!  Stillinger-Weber 2 body - Jiang and Brown variant
!  
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''sw2jb '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''sw2jb '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then 
            write(iout,'(''sw2jb'',1x,a4,1x,f6.4,2(1x,a9))') &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''sw2jb'',1x,a4,2(1x,a9))') &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f8.6,1x,f10.5,1x,f9.5,'' &'')')  &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),twopot(4,i)
          write(iout,'(2(1x,f6.3),4i2)') rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,4)
        else
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f8.6,1x,f10.5,1x,f9.5,'' &'')') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),twopot(4,i)
          write(iout,'(2(1x,f6.3))') rpot2(i),rpot(i)
        endif
      elseif (nptype(i).eq.33) then
!
!  Cosh-Spring potential
!
        write(iout,'(''cosh-spring'')')
        if (lfit) then
          write(iout,'(a5,1x,2(g14.8,1x),2i2)') lab1,twopot(1,i),twopot(2,i),itmp(20*(i-1)+1),itmp(20*(i-1)+2)
        else
          write(iout,'(a5,1x,2(g14.8,1x))')lab1,twopot(1,i),twopot(2,i)
        endif
      elseif (nptype(i).eq.34) then
!
!  EAM potential shift
!
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''eam_potential_shift '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''eam_potential_shift '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''eam_potential_shift'',1x,a4,1x,f6.4,2(1x,a9))')  &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''eam_potential_shift'',1x,a4,2(1x,a9))')  &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          if (mmexc(i).eq.1) then
            write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f8.6,2i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),(itmp(20*(i-1)+j),j=1,2)
          else
            write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f8.6,2(1x,f6.3),2i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,2)
          endif
        else
          if (mmexc(i).eq.1) then
            write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f8.6)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i)
          else
            write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f8.6,2(1x,f6.3))') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),rpot2(i),rpot(i)
          endif
        endif
      elseif (nptype(i).eq.35) then
!
!  Polynomial - harmonic
!
        norder = nint(twopot(4,i))
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''polynomial harmonic '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''polynomial harmonic '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''polynomial harmonic'',1x,a4,1x,f6.4,2(1x,a9))')  &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''polynomial harmonic'',1x,a4,2(1x,a9))')  &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        write(iout,'(i2)') norder - 1
        if (lfit) then
          if (norder.eq.2) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),2(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,2)
              write(iout,'(f12.6,3i2)') twopot(1,i),(itmp(20*(i-1)+j),j=5,6),itmp(20*(i-1)+1)
            else
              write(iout,'(2(a5,1x,a4,1x),2(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,2)
              write(iout,'(f12.6,2(f6.3,1x),3i2)') twopot(1,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=5,6),itmp(20*(i-1)+1)
            endif
          elseif (norder.eq.3) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),3(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,3)
              write(iout,'(f12.6,4i2)') twopot(1,i),(itmp(20*(i-1)+j),j=5,7),itmp(20*(i-1)+1)
            else
              write(iout,'(2(a5,1x,a4,1x),3(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,3)
              write(iout,'(f12.6,2(f6.3,1x),4i2)') twopot(1,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=5,7),itmp(20*(i-1)+1)
            endif
          elseif (norder.eq.4) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(f12.6,1x,5i2)') twopot(1,i),(itmp(20*(i-1)+j),j=5,8),itmp(20*(i-1)+1)
            else
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(f12.6,2(f6.3,1x),5i2)') twopot(1,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=5,8),itmp(20*(i-1)+1)
            endif
          elseif (norder.eq.5) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(2(f12.6,1x),6i2)') tpot(5,i),twopot(1,i),(itmp(20*(i-1)+j),j=5,9),itmp(20*(i-1)+1)
            else
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(2(f12.6,1x),2(f6.3,1x),6i2)') tpot(5,i),twopot(1,i),rpot2(i),rpot(i), &
                (itmp(20*(i-1)+j),j=5,9),itmp(20*(i-1)+1)
            endif
          elseif (norder.eq.6) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(3(f12.6,1x),7i2)') (tpot(j,i),j=5,6),twopot(1,i),(itmp(20*(i-1)+j),j=5,10),itmp(20*(i-1)+1)
            else
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(3(f12.6,1x),2(f6.3,1x),7i2)') (tpot(j,i),j=5,6),twopot(1,i),rpot2(i),rpot(i), &
                (itmp(20*(i-1)+j),j=5,10),itmp(20*(i-1)+1)
            endif
          endif
        else
          if (norder.eq.2) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),2(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,2)
              write(iout,'(f12.6)') twopot(1,i)
            else
              write(iout,'(2(a5,1x,a4,1x),2(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,2)
              write(iout,'(f12.6,2(f6.3,1x))') twopot(1,i),rpot2(i),rpot(i)
            endif
          elseif (norder.eq.3) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),3(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,3)
              write(iout,'(f12.6)') twopot(1,i)
            else
              write(iout,'(2(a5,1x,a4,1x),3(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,3)
              write(iout,'(f12.6,2(f6.3,1x))') twopot(1,i),rpot2(i),rpot(i)
            endif
          elseif (norder.eq.4) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(f12.6)') twopot(1,i)
            else
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(f12.6,2(f6.3,1x))') twopot(1,i),rpot2(i),rpot(i)
            endif
          elseif (norder.eq.5) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(2(f12.6,1x))') tpot(5,i),twopot(1,i)
            else
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(2(f12.6,1x),2(f6.3,1x))') tpot(5,i),twopot(1,i),rpot2(i),rpot(i)
            endif
          elseif (norder.eq.6) then
            if (mmexc(i).eq.1) then
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(3(f12.6,1x))') (tpot(j,i),j=5,6),twopot(1,i)
            else
              write(iout,'(2(a5,1x,a4,1x),4(f12.6,1x),''&'')') lab1,ctmp(1),lab2,ctmp(2),(tpot(j,i),j=1,4)
              write(iout,'(3(f12.6,1x),2(f6.3,1x))') (tpot(j,i),j=5,6),twopot(1,i),rpot2(i),rpot(i)
            endif
          endif
        endif
      elseif (nptype(i).eq.36) then
!
!  Coulomb over r2 potential
!
        if (lgshift(i)) then
          if (nmptr.gt.0) then
            write(iout,'(''qoverr2 grad '',a5,1x,a4,2(1x,a9))') &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''qoverr2 grad '',1x,a4,2(1x,a9))') &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        elseif (leshift(i)) then
          if (nmptr.gt.0) then
            write(iout,'(''qoverr2 energy '',a5,1x,a4,2(1x,a9))') &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''qoverr2 energy '',1x,a4,2(1x,a9))') &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (nmptr.gt.0) then
            write(iout,'(''qoverr2 '',a5,1x,a4,2(1x,a9))') &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''qoverr2'',1x,a4,2(1x,a9))') &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (mmexc(i).eq.1) then
          write(iout,'(a5,1x,a4,1x,a5,1x,a4)') lab1,ctmp(1),lab2,ctmp(2)
        else
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f10.5)') lab1,ctmp(1),lab2,ctmp(2),rpot(i)
        endif
      elseif (nptype(i).eq.37) then
!
!  Force constant potential
!
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''forceconstant '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''forceconstant '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''forceconstant '',a4,1x,f6.4,2(1x,a9))')  &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''forceconstant '',a4,2(1x,a9))')  &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          if (mmexc(i).eq.1) then
            write(iout,'(2(a5,1x,a4,1x),2(g12.6,1x),2i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),(itmp(20*(i-1)+j),j=1,2)
          else
            write(iout,'(2(a5,1x,a4,1x),2(g12.6,1x),2(f6.3,1x),2i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i), &
              rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,2)
          endif
        else
          if (mmexc(i).eq.1) then
            write(iout,'(2(a5,1x,a4,1x),2(g12.6,1x))') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i)
          else
            write(iout,'(2(a5,1x,a4,1x),2(g12.6,1x),2(f6.3,1x))') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),rpot2(i),rpot(i)
          endif
        endif
      elseif (nptype(i).eq.38) then
!
!  Short-range Glue
!
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''srglue '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''srglue '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''srglue'',1x,a4,1x,f6.4,2(1x,a9))')  &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''srglue'',1x,a4,2(1x,a9))')  &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (mmexc(i).eq.1) then
          write(iout,'(2(a5,1x,a4,1x),f14.10)') lab1,ctmp(1),lab2,ctmp(2),twopot(1,i)
        else
          write(iout,'(2(a5,1x,a4,1x),f14.10,1x,2(f8.4,1x))') lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),rpot2(i),rpot(i)
        endif
        write(iout,'(3(f18.12,1x),''&'')') (tpot(j,i),j=1,3)
        write(iout,'(2(f18.12,1x))') (tpot(j,i),j=4,5)
        write(iout,'(3(f18.12,1x),''&'')') (tpot(j,i),j=6,8)
        write(iout,'(3(f18.12,1x),''&'')') (tpot(j,i),j=9,11)
        write(iout,'(f18.12)') tpot(12,i)
      elseif (nptype(i).eq.39.or.nptype(i).eq.40) then
!
!  Morse with etaper
!
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''morse etaper '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''morse etaper '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''morse etaper '',a4,1x,f6.4,2(1x,a9))')  &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''morse etaper '',a4,2(1x,a9))')  &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          if (mmexc(i).eq.1) then
            write(iout,'(2(a5,1x,a4,1x),g13.8,1x,g10.5,1x,f8.5,1x,f7.4,1x,3i2)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),twopot(4,i),(itmp(20*(i-1)+j),j=1,3)
          else
            write(iout,'(2(a5,1x,a4,1x),g13.8,1x,g10.5,1x,f8.5,1x,f7.4,'' &'')') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),twopot(4,i)
            write(iout,'(2(1x,f6.3),1x,3i2)') rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,3)
          endif
        else
          if (mmexc(i).eq.1) then
            write(iout,'(2(a5,1x,a4,1x),g13.8,1x,g10.5,1x,f8.5,1x,f7.4)') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),twopot(4,i)
          else
            write(iout,'(2(a5,1x,a4,1x),g13.8,1x,g10.5,1x,f8.5,1x,f7.4,2(1x,f6.3))') &
              lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),twopot(4,i),rpot2(i),rpot(i)
          endif
        endif
      elseif (nptype(i).eq.41) then
!  
!  Mei-Davenport 2-body
!  
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''mei-davenport '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''mei-davenport '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then 
            write(iout,'(''mei-davenport'',1x,a4,1x,f6.4,2(1x,a9))') &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''mei-davenport'',1x,a4,2(1x,a9))') &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f8.6,1x,f10.5,1x,f9.5,'' &'')')  &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),twopot(4,i)
          write(iout,'(2(1x,f8.4),4i2)') rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,4)
        else
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f8.6,1x,f10.5,1x,f9.5,'' &'')') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),twopot(4,i)
          write(iout,'(2(1x,f8.4))') rpot2(i),rpot(i)
        endif
      elseif (nptype(i).eq.42) then
!
!  Erf-erfc 2-body
!
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''erferfc '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''erferfc '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''erferfc '',1x,a4,1x,f6.4,2(1x,a9))') &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''erferfc '',1x,a4,2(1x,a9))') &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f8.6,1x,f10.5,'' &'')')  &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i)
          write(iout,'(2(1x,f8.4),3i2)') rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,3)
        else
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f8.6,1x,f10.5,'' &'')') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i)
          write(iout,'(2(1x,f8.4))') rpot2(i),rpot(i)
        endif
      elseif (nptype(i).eq.43) then
!     
!  Rep-erfc 2-body
!
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''reperfc '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''reperfc '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''reperfc '',1x,a4,1x,f6.4,2(1x,a9))') &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''reperfc '',1x,a4,2(1x,a9))') &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f8.6,'' &'')')  &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i)
          write(iout,'(2(1x,f8.4),2i2)') rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,2)
        else
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f8.6,'' &'')') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i)
          write(iout,'(2(1x,f8.4))') rpot2(i),rpot(i)
        endif
      elseif (nptype(i).eq.44) then
! 
!  Erf 2-body
! 
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''erfpot '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''erfpot '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''erfpot '',1x,a4,1x,f6.4,2(1x,a9))') &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''erfpot '',1x,a4,2(1x,a9))') &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f8.6,'' &'')')  &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i)
          write(iout,'(2(1x,f8.4),2i2)') rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,2)
        else
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f8.6,'' &'')') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i)
          write(iout,'(2(1x,f8.4))') rpot2(i),rpot(i)
        endif
      elseif (nptype(i).eq.45) then
!
!  Baskes 2 body
!
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''baskes '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''baskes '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''baskes'',1x,a4,1x,f6.4,2(1x,a9))') &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''baskes'',1x,a4,2(1x,a9))') &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f8.6,2(1x,f10.5),'' &'')') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),twopot(4,i)
          write(iout,'(22x,f10.5,2(1x,f10.5),2(1x,f6.3),5i2)') &
            twopot(5,i),twopot(6,i),twopot(7,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,4),itmp(20*(i-1)+7)
        else
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f8.6,2(1x,f10.5),'' &'')') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),twopot(4,i)
          write(iout,'(22x,f10.5,2(1x,f10.5),2(1x,f6.3))') twopot(5,i),twopot(6,i),twopot(7,i),rpot2(i),rpot(i)
        endif
        write(iout,'(22x,4(f10.5,1x))') (tpot(j,i),j=1,4)
        write(iout,'(22x,4(f10.5,1x))') (tpot(j,i),j=5,8)
        write(iout,'(22x,4(f10.5,1x))') (tpot(j,i),j=9,12)
      elseif (nptype(i).eq.46) then
!
!  VBO 2 body
!
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''vbo_twobody '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''vbo_twobody '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''vbo_twobody'',1x,a4,1x,f6.4,2(1x,a9))') &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''vbo_twobody'',1x,a4,2(1x,a9))') &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f10.6,2(1x,f8.5),4i2)') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),twopot(4,i),(itmp(20*(i-1)+j),j=1,4)
        else
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f10.6,2(1x,f8.5))') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),twopot(4,i)
        endif
      elseif (nptype(i).eq.47) then
!
!  Exp-powers 2 body
!
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''exppowers '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''exppowers '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''exppowers'',1x,a4,1x,f6.4,2(1x,a9))') &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''exppowers'',1x,a4,2(1x,a9))') &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f8.6,2(1x,f10.5),'' &'')') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),twopot(4,i)
          write(iout,'(22x,f10.5,2(1x,f6.3),5i2)') &
            twopot(5,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,5),itmp(20*(i-1)+7)
        else
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f8.6,2(1x,f10.5),'' &'')') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i),twopot(4,i)
          write(iout,'(22x,f10.5,2(1x,f6.3))') twopot(5,i),rpot2(i),rpot(i)
        endif
      elseif (nptype(i).eq.48) then
!
!  Grimme_C6
!
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''grimme_c6 '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''grimme_c6 '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''grimme_c6'',1x,a4,1x,f6.4,2(1x,a9))') &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''grimme_c6'',1x,a4,2(1x,a9))') &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,2(1x,f10.5),'' &'')') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i)
          write(iout,'(21x,2(1x,f6.3),3i2)') &
            rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,3)
        else
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,2(1x,f10.5),'' &'')') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i)
          write(iout,'(21x,2(1x,f6.3))') rpot2(i),rpot(i)
        endif
      elseif (nptype(i).eq.49) then
!
!  CFM_harmonic
!
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''cfm_harmonic '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''cfm_harmonic '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''cfm_harmonic'',1x,a4,1x,f6.4,2(1x,a9))') &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''cfm_harmonic'',1x,a4,2(1x,a9))') &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,2(1x,f10.5),'' &'')') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i)
          write(iout,'(21x,f10.5,2(1x,f6.3),4i2)') &
            twopot(4,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,4)
        else
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,2(1x,f10.5),'' &'')') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i)
          write(iout,'(21x,f10.5,2(1x,f6.3))') twopot(4,i),rpot2(i),rpot(i)
        endif
      elseif (nptype(i).eq.50) then
!     
!  CFM_gaussian
! 
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''cfm_gaussian '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''cfm_gaussian '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''cfm_gaussian'',1x,a4,1x,f6.4,2(1x,a9))') &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''cfm_gaussian'',1x,a4,2(1x,a9))') &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,2(1x,f10.5),'' &'')') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i)
          write(iout,'(21x,f10.5,1x,f10.5,2(1x,f6.3),5i2)') &
            twopot(4,i),twopot(5,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,5)
        else
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,2(1x,f10.5),'' &'')') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i)
          write(iout,'(21x,f10.5,1x,f10.5,2(1x,f6.3))') twopot(4,i),twopot(5,i),rpot2(i),rpot(i)
        endif
      elseif (nptype(i).eq.51) then
!     
!  CFM_power
! 
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''cfm_power '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''cfm_power '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''cfm_power'',1x,a4,1x,f6.4,2(1x,a9))') &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''cfm_power'',1x,a4,2(1x,a9))') &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,2(1x,f10.5),'' &'')') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i)
          write(iout,'(21x,f10.5,2(1x,f6.3),4i2)') &
            twopot(4,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,4)
        else
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,2(1x,f10.5),'' &'')') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i)
          write(iout,'(21x,f10.5,2(1x,f6.3))') twopot(4,i),rpot2(i),rpot(i)
        endif
      elseif (nptype(i).eq.52) then
!     
!  CFM_fermi
! 
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''cfm_fermi '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''cfm_fermi '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''cfm_fermi'',1x,a4,1x,f6.4,2(1x,a9))') &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''cfm_fermi'',1x,a4,2(1x,a9))') &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,2(1x,f10.5),'' &'')') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i)
          write(iout,'(21x,f10.5,1x,f10.5,2(1x,f6.3),5i2)') &
            twopot(4,i),twopot(5,i),rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,5)
        else
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,2(1x,f10.5),'' &'')') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),twopot(3,i)
          write(iout,'(21x,f10.5,1x,f10.5,2(1x,f6.3))') twopot(4,i),twopot(5,i),rpot2(i),rpot(i)
        endif
      elseif (nptype(i).eq.53) then
!
!  gCoulomb
!
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''gcoulomb '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''gcoulomb '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''gcoulomb'',1x,a4,1x,f6.4,2(1x,a9))') &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''gcoulomb'',1x,a4,2(1x,a9))') &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f12.6,'' &'')')  &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i)
          write(iout,'(2(1x,f8.4),2i2)') rpot2(i),rpot(i),(itmp(20*(i-1)+j),j=1,2)
        else
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f12.6,'' &'')') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i)
          write(iout,'(2(1x,f8.4))') rpot2(i),rpot(i)
        endif
      elseif (nptype(i).eq.54) then
!
!  Becke_Johnson_C6
!
        if (nmptr.gt.0) then
          if (l14scale) then
            write(iout,'(''becke_johnson_c6 '',a5,1x,a4,1x,f6.4,2(1x,a9))')  &
              mword(nmptr),mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''becke_johnson_c6 '',a5,1x,a4,2(1x,a9))')  &
              mword(nmptr),mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        else
          if (l14scale) then
            write(iout,'(''becke_johnson_c6'',1x,a4,1x,f6.4,2(1x,a9))') &
              mmword,scale14(i),(botyword(nbotyptr(j)),j=1,nboty)
          else
            write(iout,'(''becke_johnson_c6'',1x,a4,2(1x,a9))') &
              mmword,(botyword(nbotyptr(j)),j=1,nboty)
          endif
        endif
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f10.5,2(1x,f6.3),2i2)') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),rpot2(i),rpot(i), &
            (itmp(20*(i-1)+j),j=1,2)
        else
          write(iout,'(a5,1x,a4,1x,a5,1x,a4,1x,f14.6,1x,f10.5,2(1x,f6.3))') &
            lab1,ctmp(1),lab2,ctmp(2),twopot(1,i),twopot(2,i),rpot2(i),rpot(i)
        endif
      endif
    enddo loop2body
  endif
!**************************************************
!  Sigma/epsilon for combination rule potentials  *
!**************************************************
  if (nlib.gt.0.and..not.llibdump) then
    nspo = nlibseps
  else
    nspo = nseps
  endif
  if (nspo.gt.0) then
    if (lfit) then
      do i = 1,2*nspo
        itmp(i) = 0
      enddo
      do i = 1,nfit
        nt = nftyp(i)
        if (nt.eq.1) then
          np = nfpot(i)
          nv = nfvar(i)
          if (np.eq.7) itmp(2*(nv-1)+1) = 1
          if (np.eq.8) itmp(2*(nv-1)+2) = 1
        endif
      enddo
    endif
    do i = 1,nspo
      nat1 = natse(i)
      itype1 = ntypse(i)
      call label(nat1,itype1,lab1)
      if (nat1.gt.maxele) then
        ctmp(1) = 'shel'
      else
        ctmp(1) = 'core'
      endif
      write(iout,'(''epsilon/sigma'')')
      if (lfit) then
        write(iout,'(a5,1x,a4,1x,g12.6,1x,g12.6,2i2)') &
          lab1,ctmp(1),epsilon(i),sigma(i),itmp(2*(i-1)+1),itmp(2*(i-1)+2)
      else
        write(iout,'(a5,1x,a4,1x,g12.6,1x,g12.6)') lab1,ctmp(1),epsilon(i),sigma(i)
      endif
    enddo
  endif
!************************************************
!  Atom AB for lennard-jones combination rules  *
!************************************************
  if (nlib.gt.0.and..not.llibdump) then
    nab = nlibatab
  else
    nab = natab
  endif
  if (nab.gt.0) then
    if (lfit) then
      do i = 1,2*nab
        itmp(i) = 0
      enddo
      do i = 1,nfit
        nt = nftyp(i)
        if (nt.eq.1) then
          np = nfpot(i)
          nv = nfvar(i)
          if (np.eq.9) itmp(2*(nv-1)+1) = 1
          if (np.eq.10) itmp(2*(nv-1)+2) = 1
        endif
      enddo
    endif
    do i = 1,nab
      nat1 = nattab(i)
      itype1 = ntypab(i)
      call label(nat1,itype1,lab1)
      if (nat1.gt.maxele) then
        ctmp(1) = 'shel'
      else
        ctmp(1) = 'core'
      endif
      write(iout,'(''atomab'')')
      if (lfit) then
        write(iout,'(a5,1x,a4,1x,f14.4,1x,f10.4,2i2)') lab1,ctmp(1), &
          atoma(i),atomb(i),itmp(2*(i-1)+1),itmp(2*(i-1)+2)
      else
        write(iout,'(a5,1x,a4,1x,f14.4,1x,f10.4)') lab1,ctmp(1),atoma(i),atomb(i)
      endif
    enddo
  endif
!***************************
!  UFF species parameters  *
!***************************
  if (nlib.gt.0.and..not.llibdump) then
    nspo = nlibUFFsp
  else
    nspo = nUFFspec
  endif
  if (nspo.gt.0) then
    if (lfit) then
      do i = 1,10*nspo
        itmp(i) = 0
      enddo
      do i = 1,nfit
        nt = nftyp(i)
        if (nt.eq.1) then
          np = nfpot(i)
          nv = nfvar(i)
          if (np.eq.20) itmp(2*(nv-1)+1) = 1
          if (np.eq.21) itmp(2*(nv-1)+2) = 1
          if (np.eq.22) itmp(2*(nv-1)+3) = 1
          if (np.eq.23) itmp(2*(nv-1)+4) = 1
          if (np.eq.24) itmp(2*(nv-1)+5) = 1
          if (np.eq.25) itmp(2*(nv-1)+6) = 1
          if (np.eq.26) itmp(2*(nv-1)+7) = 1
          if (np.eq.30) itmp(2*(nv-1)+8) = 1
          if (np.eq.31) itmp(2*(nv-1)+9) = 1
          if (np.eq.32) itmp(2*(nv-1)+10) = 1
        endif
      enddo
    endif
    do i = 1,nspo
      nat1 = natUFFspec(i)
      itype1 = ntypUFFspec(i)
      call label(nat1,itype1,lab1)
      if (nat1.gt.maxele) then
        ctmp(1) = 'shel'
      else
        ctmp(1) = 'core'
      endif
      write(iout,'(''uff1'')')
      write(iout,'(a5,1x,a4,1x,f8.5,1x,f8.3,1x,f8.5,1x,f9.5,1x,f9.4,1x,f8.5,'' &'')') &
        lab1,ctmp(1),UFFr(i),UFFtheta(i),UFFx(i),UFFd(i),UFFzeta(i),UFFZeff(i)
      if (lfit) then
        write(iout,'(i2,f6.3,1x,f7.4,1x,f7.4,1x,f8.5,1x,10i2)') &
          nUFFtype(i),UFFtor(i),UFFKoop(i),UFFthetaoop(i),UFFchi(i),(itmp(2*(i-1)+j),j=1,10)
      else
        write(iout,'(i2,f6.3,1x,f7.4,1x,f7.4,1x,f8.5)') &
          nUFFtype(i),UFFtor(i),UFFKoop(i),UFFthetaoop(i),UFFchi(i)
      endif
    enddo
  endif
!********************
!  EAM functionals  *
!********************
  if (neamfnspec.gt.0) then
    if (lfit) then
      itmps(1:9+maxmeamorder,1:neamfnspec,1) = 0
      do i = 1,nfit
        nt = nftyp(i)
        if (nt.eq.5) then
          nv = nfvar(i)
          np = nfpot(i)
          if (nv.eq.4) then
            itmps(1,np,1) = 1
          elseif (nv.eq.5) then
            itmps(2,np,1) = 1
          elseif (nv.eq.6) then
            itmps(3,np,1) = 1
          elseif (nv.eq.9) then
            itmps(4,np,1) = 1
          elseif (nv.eq.10) then
            itmps(5,np,1) = 1
          elseif (nv.eq.11) then
            itmps(6,np,1) = 1
          elseif (nv.eq.12) then
            itmps(7,np,1) = 1
          elseif (nv.eq.13) then
            itmps(8,np,1) = 1
          elseif (nv.eq.14) then
            itmps(9,np,1) = 1
          elseif (nv.eq.19) then
            nv2 = nfvar2(i)
            itmps(9+nv2,np,1) = 1
          endif
        endif
      enddo
    endif
!
    do i = 1,neamfnspec
      nat1 = neamfnnat(i)
      itype1 = neamfntyp(i)
      if (llibsymdump) then
        lab1 = symboleamfnspec(i)
      else
        call label(nat1,itype1,lab1)
      endif
      if (nat1.gt.maxele) then
        ctmp(1) = 'shel'
      else
        ctmp(1) = 'core'
      endif
!
!  Set any MEAM sub-options
!
      nmeamword = 0
      if (neamfnmeamcombotype(i).eq.1) then
        nmeamword = nmeamword + 1
        meamword(nmeamword) = 'sum'
      endif
      if (neamfnmeamtype(i).eq.1) then
        nmeamword = nmeamword + 1
        meamword(nmeamword) = 't21'
      elseif (neamfnmeamtype(i).eq.2) then
        nmeamword = nmeamword + 1
        meamword(nmeamword) = 't24'
      endif
!
      if (neamfn.eq.1.or.neamfn.eq.2) then
        if (neamfnmeamorder(i).gt.1) then
          if (neamfn.eq.1) then
            write(iout,'(''meam_functional square_root '',i2,2(1x,a3))') neamfnmeamorder(i)-1,(meamword(j),j=1,nmeamword)
          elseif (neamfn.eq.2) then
            write(iout,'(''meam_functional power '',2i2,2(1x,a3))') neamfnmeamorder(i)-1,neampower,(meamword(j),j=1,nmeamword)
          endif
        else
          if (neamfn.eq.1) then
            write(iout,'(''eam_functional square_root'')')
          elseif (neamfn.eq.2) then
            write(iout,'(''eam_functional power '',i2)') neampower
          endif
        endif
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,f16.6,1x,i2)') lab1,ctmp(1),eamfnpar(1,i),itmps(1,i,1)
        else
          write(iout,'(a5,1x,a4,1x,f16.6,1x)') lab1,ctmp(1),eamfnpar(1,i)
        endif
      elseif (neamfn.eq.3) then
        if (neamfnmeamorder(i).gt.1) then
          write(iout,'(''meam_functional banerjea_smith '',2i2,2(1x,a3))') neamfnmeamorder(i)-1,neampower, &
            (meamword(j),j=1,nmeamword)
        else
          write(iout,'(''eam_functional banerjea_smith '',i2)') neampower
        endif
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,f16.6,1x,2(f10.5,1x),3i2)') &
            lab1,ctmp(1),(eamfnpar(j,i),j=1,3),(itmps(j,i,1),j=1,3)
        else
          write(iout,'(a5,1x,a4,1x,f16.6,1x,2(f10.5,1x))') &
            lab1,ctmp(1),(eamfnpar(j,i),j=1,3)
        endif
      elseif (neamfn.eq.4) then
        if (neamfnmeamorder(i).gt.1) then
          write(iout,'(''meam_functional numerical '',i2,2(1x,a3))') neamfnmeamorder(i)-1,(meamword(j),j=1,nmeamword)
        else
          write(iout,'(''eam_functional numerical '')')
        endif
        write(iout,'(a5,1x,a4,1x,a80)') lab1,ctmp(1),eamfnfile(i)
      elseif (neamfn.eq.5) then
        if (neamfnmeamorder(i).gt.1) then
          write(iout,'(''meam_functional johnson '',i2,2(1x,a3))') neamfnmeamorder(i)-1,(meamword(j),j=1,nmeamword)
        else
          write(iout,'(''eam_functional johnson '')') 
        endif
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,f16.6,1x,6(f10.5,1x),6i2)') &
            lab1,ctmp(1),(eamfnpar(j,i),j=1,6),(itmps(j,i,1),j=1,6)
        else
          write(iout,'(a5,1x,a4,1x,f16.6,1x,6(f10.5,1x))') &
            lab1,ctmp(1),(eamfnpar(j,i),j=1,6)
        endif
      elseif (neamfn.eq.6) then
        if (neamfnmeamorder(i).gt.1) then
          write(iout,'(''meam_functional glue '',i2,2(1x,a3))') neamfnmeamorder(i)-1,(meamword(j),j=1,nmeamword)
        else
          write(iout,'(''eam_functional glue '')') 
        endif
        write(iout,'(a5,1x,a4,1x,f16.12,1x,f16.12)') &
          lab1,ctmp(1),(eamfnpar(j,i),j=1,2)
        write(iout,'(3(f18.12,1x),''&'')') &
          (eamfnpar(j,i),j=3,5)
        write(iout,'(2(f18.12,1x))') &
          (eamfnpar(j,i),j=6,7)
        write(iout,'(3(f18.12,1x),''&'')') &
          (eamfnpar(j,i),j=8,10)
        write(iout,'(2(f18.12,1x))') &
          (eamfnpar(j,i),j=11,12)
        write(iout,'(3(f18.12,1x),''&'')') &
          (eamfnpar(j,i),j=13,15)
        write(iout,'(f18.12)') &
          eamfnpar(16,i)
      elseif (neamfn.eq.7) then
        if (neamfnmeamorder(i).gt.1) then
          write(iout,'(''meam_functional foiles '',i2,2(1x,a3))') neamfnmeamorder(i)-1,(meamword(j),j=1,nmeamword)
        else
          write(iout,'(''eam_functional foiles'')') 
        endif
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,f16.6,1x,4(f10.5,1x),4i2)') &
            lab1,ctmp(1),(eamfnpar(j,i),j=1,4),(itmps(j,i,1),j=1,4)
        else
          write(iout,'(a5,1x,a4,1x,f16.6,1x,4(f10.5,1x))') &
            lab1,ctmp(1),(eamfnpar(j,i),j=1,4)
        endif
      elseif (neamfn.eq.8) then
        if (neamfnmeamorder(i).gt.1) then
          write(iout,'(''meam_functional mei-davenport '',i2,2(1x,a3))') neamfnmeamorder(i)-1,(meamword(j),j=1,nmeamword)
        else
          write(iout,'(''eam_functional mei-davenport'')')
        endif
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,f12.6,1x,4(f10.5,1x),''&'')') &
            lab1,ctmp(1),(eamfnpar(j,i),j=1,5)
          write(iout,'(11x,4(f10.5,1x),9i2)') &
            (eamfnpar(j,i),j=6,9),(itmps(j,i,1),j=1,9)
        else
          write(iout,'(a5,1x,a4,1x,f12.6,1x,4(f10.5,1x),''&'')') &
            lab1,ctmp(1),(eamfnpar(j,i),j=1,5)
          write(iout,'(11x,4(f10.5,1x))') (eamfnpar(j,i),j=6,9)
        endif
      elseif (neamfn.eq.9) then
        if (neamfnmeamorder(i).gt.1) then
          write(iout,'(''meam_functional baskes '',i2,2(1x,a3))') neamfnmeamorder(i)-1,(meamword(j),j=1,nmeamword)
        else
          write(iout,'(''eam_functional baskes '')') 
        endif
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,f16.6,1x,f10.5,1x,2i2)') &
            lab1,ctmp(1),eamfnpar(1,i),eamfnpar(2,i),itmps(1,i,1),itmps(2,i,1)
        else
          write(iout,'(a5,1x,a4,1x,f16.6,1x,f10.5)') &
            lab1,ctmp(1),eamfnpar(1,i),eamfnpar(2,i)
        endif
      elseif (neamfn.eq.10) then
        if (neamfnmeamorder(i).gt.1) then
          write(iout,'(''meam_functional vbo '',i2,2(1x,a3))') neamfnmeamorder(i)-1,(meamword(j),j=1,nmeamword)
        else
          write(iout,'(''eam_functional vbo '')') 
        endif
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,f16.6,1x,f10.5,1x,2i2)') &
            lab1,ctmp(1),eamfnpar(1,i),eamfnpar(2,i),itmps(1,i,1),itmps(2,i,1)
        else
          write(iout,'(a5,1x,a4,1x,f16.6,1x,f10.5)') &
            lab1,ctmp(1),eamfnpar(1,i),eamfnpar(2,i)
        endif
      elseif (neamfn.eq.11) then
        if (neamfnmeamorder(i).gt.1) then
          write(iout,'(''meam_functional belashchenko '',i2,2(1x,a3))') neamfnmeamorder(i)-1,(meamword(j),j=1,nmeamword)
        else
          write(iout,'(''eam_functional belashchenko '')')
        endif
        write(iout,'(a5,1x,a4,3(1x,f12.8))') &
          lab1,ctmp(1),(eamfnpar(j,i),j=1,3)
        write(iout,'(10x,4(1x,f12.8))') &
          (eamfnpar(j,i),j=4,7)
        write(iout,'(4x,3(f14.8,1x))') &
          eamfnpar(8,i),eamfnpar(32,i),eamfnpar(33,i)
        write(iout,'(4x,4(f14.8,1x))') &
          (eamfnpar(j,i),j=24,27)
        write(iout,'(4x,4(f14.8,1x))') &
          (eamfnpar(j,i),j=28,31)
      endif
      if (neamfnmeamorder(i).eq.4) then
        if (lfit) then
          write(iout,'(11x,4f10.6,1x,4i2)') (eamfnmeamcoeff(1,i),j=1,4),(itmps(9+k,i,1),k=1,4)
        else
          write(iout,'(11x,4f10.6,1x)') (eamfnmeamcoeff(j,i),j=1,4)
        endif
      elseif (neamfnmeamorder(i).eq.3) then
        if (lfit) then
          write(iout,'(11x,3f10.6,1x,3i2)') (eamfnmeamcoeff(1,i),j=1,3),(itmps(9+k,i,1),k=1,3)
        else
          write(iout,'(11x,3f10.6,1x)') (eamfnmeamcoeff(j,i),j=1,3)
        endif
      elseif (neamfnmeamorder(i).eq.2) then
        if (lfit) then
          write(iout,'(11x,2f10.6,1x,2i2)') (eamfnmeamcoeff(1,i),j=1,2),(itmps(9+k,i,1),k=1,2)
        else
          write(iout,'(11x,2f10.6,1x)') (eamfnmeamcoeff(j,i),j=1,2)
        endif
      endif
    enddo
  endif
!******************
!  EAM densities  *
!******************
  if (neamspec.gt.0) then
    if (lfit) then
      itmps(1:7*neamspec,1:maxeamden,1:maxmeamorder) = 0
      do i = 1,nfit
        nt = nftyp(i)
        if (nt.eq.5) then
          nv = nfvar(i)
          if (nv.le.3) then
            np = nfpot(i)
            itmps(7*(np-1) + nv,nfvar2(i),nfvar3(i)) = 1
          elseif (nv.ge.15.and.nv.le.18) then
            np = nfpot(i)
            itmps(7*(np-1) + nv - 11,nfvar2(i),nfvar3(i)) = 1
          endif
        endif
      enddo
    endif
    do i = 1,neamspec
      nat1 = neamnat(i)
      itype1 = neamtyp(i)
      if (llibsymdump) then
        lab1 = symboleamspec(1,i)
      else
        call label(nat1,itype1,lab1)
      endif
      if (nat1.gt.maxele) then
        ctmp(1) = 'shel'
      else
        ctmp(1) = 'core'
      endif
      if (neamnat2(i).gt.0) then
        nat2 = neamnat2(i)
        itype2 = neamtyp2(i)
        if (llibsymdump) then
          lab2 = symboleamspec(2,i)
        else
          call label(nat2,itype2,lab2)
        endif
        if (nat2.gt.maxele) then
          ctmp(2) = 'shel'
        else
          ctmp(2) = 'core'
        endif
        do j = 1,ndenfncomp(i)
          if (ndenfn(j,i).gt.0) then
            if (ndenfn(j,i).eq.1) then
!
!  Power law => Sutton-Chen
!
              if (neammeamorder(j,i).gt.1) then
                write(iout,'(''meam_density power '',i2,1x,i2)') neammeamorder(j,i)-1,nint(denpar(6,1,j,i))
                if (lfit) then
                  write(iout,'(2(a5,1x,a4,1x),f16.6,1x,i2)') &
                    lab1,ctmp(1),lab2,ctmp(2),denpar(1,1,j,i),itmps(7*(i-1)+1,j,1)
                else
                  write(iout,'(2(a5,1x,a4,1x),f16.6,1x)') &
                    lab1,ctmp(1),lab2,ctmp(2),denpar(1,1,j,i)
                endif
              else
                write(iout,'(''eam_density power '',i2)') nint(denpar(6,1,j,i))
                if (lfit) then
                  write(iout,'(2(a5,1x,a4,1x),f16.6,i2)') &
                    lab1,ctmp(1),lab2,ctmp(2),denpar(1,1,j,i),itmps(7*(i-1)+1,j,1)
                else
                  write(iout,'(2(a5,1x,a4,1x),f16.6)') lab1,ctmp(1),lab2,ctmp(2),denpar(1,1,j,i)
                endif
              endif
              if (neammeamorder(j,i).gt.1) then
                do l = 2,neammeamorder(j,i)
                  if (lfit) then
                    write(iout,'(22x,f16.6,1x,i2)') &
                    denpar(1,l,j,i),itmps(7*(i-1)+1,j,l)
                  else
                    write(iout,'(22x,f16.6,1x)') denpar(1,l,j,i)
                  endif
                enddo
              endif
            elseif (ndenfn(j,i).eq.2.or.ndenfn(j,i).eq.12) then
!
!  Exponential / Baskes
!
              if (ndenfn(j,i).eq.2) then
                if (neammeamorder(j,i).gt.1) then
                  write(iout,'(''meam_density exponential '',i2,1x,i2)') neammeamorder(j,i)-1,nint(denpar(6,1,j,i))
                else
                  write(iout,'(''eam_density exponential '',i2)') nint(denpar(6,1,j,i))
                endif
              else
                if (neammeamorder(j,i).gt.1) then
                  write(iout,'(''meam_density baskes '',i2)') neammeamorder(j,i)-1
                else
                  write(iout,'(''eam_density baskes '')') 
                endif
              endif
              if (neammeamorder(j,i).gt.1) then
                if (lfit) then
                  write(iout,'(2(a5,1x,a4,1x),f14.6,1x,2(f10.5,1x),3i2)') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,3),(itmps(7*(i-1)+k,j,1),k=1,3)
                else
                  write(iout,'(2(a5,1x,a4,1x),f14.6,1x,2(f10.5,1x))') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,3)
                endif
              else
                if (lfit) then
                  write(iout,'(2(a5,1x,a4,1x),f14.6,1x,2(f10.5,1x),3i2)') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,3),(itmps(7*(i-1)+k,j,1),k=1,3)
                else
                  write(iout,'(2(a5,1x,a4,1x),f14.6,1x,2(f10.5,1x))')lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,3)
                endif
              endif
              if (neammeamorder(j,i).gt.1) then
                do l = 2,neammeamorder(j,i)
                  if (lfit) then
                    write(iout,'(22x,f14.6,1x,2(f10.5,1x),3i2)') &
                      (denpar(k,l,j,i),k=1,3),(itmps(7*(i-1)+k,j,l),k=1,3)
                  else
                    write(iout,'(22x,f14.6,1x,2(f10.5,1x))') (denpar(k,l,j,i),k=1,3)
                  endif
                enddo
              endif
            elseif (ndenfn(j,i).eq.3) then
!
!  Gaussian
!
              if (neammeamorder(j,i).gt.1) then
                write(iout,'(''meam_density gaussian '',i2,1x,i2)') neammeamorder(j,i)-1,nint(denpar(6,1,j,i))
                if (lfit) then
                  write(iout,'(2(a5,1x,a4,1x),f14.6,1x,2(f10.5,1x),3i2)') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,3),(itmps(7*(i-1)+k,j,1),k=1,3)
                else
                  write(iout,'(2(a5,1x,a4,1x),f14.6,1x,2(f10.5,1x))') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,3)
                endif
              else
                write(iout,'(''eam_density gaussian '',i2)') nint(denpar(6,1,j,i))
                if (lfit) then
                  write(iout,'(2(a5,1x,a4,1x),f14.6,1x,2(f10.5,1x),3i2)') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,3),(itmps(7*(i-1)+k,j,1),k=1,3)
                else
                  write(iout,'(2(a5,1x,a4,1x),f14.6,1x,2(f10.5,1x))')lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,3)
                endif
              endif
              if (neammeamorder(j,i).gt.1) then
                do l = 2,neammeamorder(j,i)
                  if (lfit) then
                    write(iout,'(22x,f14.6,1x,2(f10.5,1x),3i2)') &
                      (denpar(k,l,j,i),k=1,3),(itmps(7*(i-1)+k,j,l),k=1,3)
                  else
                    write(iout,'(22x,f14.6,1x,2(f10.5,1x))') (denpar(k,l,j,i),k=1,3)
                  endif
                enddo
              endif
            elseif (ndenfn(j,i).eq.4) then
!
!  Cubic form
!
              if (neammeamorder(j,i).gt.1) then
                write(iout,'(''meam_density cubic'',i2)') neammeamorder(j,i)-1
                if (lfit) then
                  write(iout,'(2(a5,1x,a4,1x),f14.6,1x,2(f14.9,1x),3i2)') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,2),(itmps(7*(i-1)+k,j,1),k=1,2)
                else
                  write(iout,'(2(a5,1x,a4,1x),f14.6,1x,2(f14.9,1x))') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,2)
                endif
              else
                write(iout,'(''eam_density cubic'')')
                if (lfit) then
                  write(iout,'(2(a5,1x,a4,1x),f14.6,1x,2(f14.9,1x),3i2)') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,2),(itmps(7*(i-1)+k,j,1),k=1,2)
                else
                  write(iout,'(2(a5,1x,a4,1x),f14.6,1x,2(f14.9,1x))') lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,2)
                endif
              endif
              if (neammeamorder(j,i).gt.1) then
                do l = 2,neammeamorder(j,i)
                  if (lfit) then
                    write(iout,'(22x,f14.6,1x,2(f14.9,1x),3i2)') &
                      (denpar(k,l,j,i),k=1,2),(itmps(7*(i-1)+k,j,l),k=1,2)
                  else
                    write(iout,'(22x,f14.6,1x,2(f14.9,1x))') (denpar(k,l,j,i),k=1,2)
                  endif
                enddo
              endif
            elseif (ndenfn(j,i).eq.5) then
!
!  Voter-Chen form
!
              if (neammeamorder(j,i).gt.1) then
                write(iout,'(''meam_density voter'',i2)') neammeamorder(j,i)-1
                if (lfit) then
                  write(iout,'(2(a5,1x,a4,1x),f14.6,1x,2(f14.9,1x),3i2)') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,2),(itmps(7*(i-1)+k,j,1),k=1,2)
                else
                  write(iout,'(2(a5,1x,a4,1x),f14.6,1x,2(f14.9,1x))') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,2)
                endif
              else
                write(iout,'(''eam_density voter'')')
                if (lfit) then
                  write(iout,'(2(a5,1x,a4,1x),f14.6,1x,2(f14.9,1x),3i2)') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,2),(itmps(7*(i-1)+k,j,1),k=1,2)
                else
                  write(iout,'(2(a5,1x,a4,1x),f14.6,1x,2(f14.9,1x))') lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,2)
                endif
              endif
              if (neammeamorder(j,i).gt.1) then
                do l = 2,neammeamorder(j,i)
                  if (lfit) then
                    write(iout,'(22x,f14.6,1x,2(f14.9,1x),3i2)') &
                      (denpar(k,l,j,i),k=1,2),(itmps(7*(i-1)+k,j,l),k=1,2)
                  else
                    write(iout,'(22x,f14.6,1x,2(f14.9,1x))') (denpar(k,l,j,i),k=1,2)
                  endif
                enddo
              endif
            elseif (ndenfn(j,i).eq.6) then
!
!  Quadratic form
!
              if (neammeamorder(j,i).gt.1) then
                write(iout,'(''meam_density quadratic'',i2)') neammeamorder(j,i)-1
                if (lfit) then
                  write(iout,'(2(a5,1x,a4,1x),f14.6,1x,2(f14.9,1x),3i2)') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,2),(itmps(7*(i-1)+k,j,1),k=1,2)
                else
                  write(iout,'(2(a5,1x,a4,1x),f14.6,1x,2(f14.9,1x))') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,2)
                endif
              else
                write(iout,'(''eam_density quadratic'')')
                if (lfit) then
                  write(iout,'(2(a5,1x,a4,1x),f14.6,1x,2(f14.9,1x),3i2)') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,2),(itmps(7*(i-1)+k,j,1),k=1,2)
                else
                  write(iout,'(2(a5,1x,a4,1x),f14.6,1x,2(f14.9,1x))') lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,2)
                endif
              endif
              if (neammeamorder(j,i).gt.1) then
                do l = 2,neammeamorder(j,i)
                  if (lfit) then
                    write(iout,'(22x,f14.6,1x,2(f14.9,1x),3i2)') &
                      (denpar(k,l,j,i),k=1,2),(itmps(7*(i-1)+k,j,l),k=1,2)
                  else
                    write(iout,'(22x,f14.6,1x,2(f14.9,1x))') (denpar(k,l,j,i),k=1,2)
                  endif
                enddo
              endif
            elseif (ndenfn(j,i).eq.7) then
!
!  Quartic form
!
              if (neammeamorder(j,i).gt.1) then
                write(iout,'(''meam_density quartic'',i2)') neammeamorder(j,i)-1
                if (lfit) then
                  write(iout,'(2(a5,1x,a4,1x),2(f14.9,1x),2i2)') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,2),(itmps(7*(i-1)+k,j,1),k=1,2)
                else
                  write(iout,'(2(a5,1x,a4,1x),2(f14.9,1x))') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,2)
                endif
              else
                write(iout,'(''eam_density quartic'')')
                if (lfit) then
                  write(iout,'(2(a5,1x,a4,1x),2(f14.9,1x),2i2)') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,2),(itmps(7*(i-1)+k,j,1),k=1,2)
                else
                  write(iout,'(2(a5,1x,a4,1x),2(f14.9,1x))') lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,2)
                endif
              endif
              if (neammeamorder(j,i).gt.1) then
                do l = 2,neammeamorder(j,i)
                  if (lfit) then
                    write(iout,'(22x,2(f14.9,1x),3i2)') &
                      (denpar(k,l,j,i),k=1,2),(itmps(7*(i-1)+k,j,l),k=1,2)
                  else
                    write(iout,'(22x,2(f14.9,1x))') (denpar(k,l,j,i),k=1,2)
                  endif
                enddo
              endif
            elseif (ndenfn(j,i).eq.8) then
!
!  Glue polynomial form
!
              if (neammeamorder(j,i).gt.1) then
                write(iout,'(''meam_density glue'',i2)') neammeamorder(j,i)-1
                write(iout,'(2(a5,1x,a4,1x),3(f14.10,1x))') &
                  lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,3)
              else
                write(iout,'(''eam_density glue'')')
                write(iout,'(2(a5,1x,a4,1x),3(f14.10,1x))') lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,3)
              endif
              write(iout,'(4(f18.12,1x))') (denpar(k,1,j,i),k=4,7)
              write(iout,'(4(f18.12,1x))') (denpar(k,1,j,i),k=8,11)
              write(iout,'(4(f18.12,1x))') (denpar(k,1,j,i),k=12,15)
              if (neammeamorder(j,i).gt.1) then
                do l = 2,neammeamorder(j,i)
                  write(iout,'(22x,3(f14.10,1x))') (denpar(k,l,j,i),k=1,3)
                  write(iout,'(4(f18.12,1x))') (denpar(k,l,j,i),k=4,7)
                  write(iout,'(4(f18.12,1x))') (denpar(k,l,j,i),k=8,11)
                  write(iout,'(4(f18.12,1x))') (denpar(k,l,j,i),k=12,15)
                enddo
              endif
            elseif (ndenfn(j,i).eq.9) then
!
!  Voter-Chen form with exponential
!
              if (neammeamorder(j,i).gt.1) then
                write(iout,'(''meam_density evoter'',i2)') neammeamorder(j,i)-1
                if (lfit) then
                  write(iout,'(2(a5,1x,a4,1x),f14.6,1x,2(f14.9,1x),3i2)') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,2),(itmps(7*(i-1)+k,j,1),k=1,2)
                else
                  write(iout,'(2(a5,1x,a4,1x),f14.6,1x,2(f14.9,1x))') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,2)
                endif
              else
                write(iout,'(''eam_density evoter'')')
                if (lfit) then
                  write(iout,'(2(a5,1x,a4,1x),f14.6,1x,2(f14.9,1x),3i2)') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,2),(itmps(7*(i-1)+k,j,1),k=1,2)
                else
                  write(iout,'(2(a5,1x,a4,1x),f14.6,1x,2(f14.9,1x))') lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,2)
                endif
              endif
              if (neammeamorder(j,i).gt.1) then
                do l = 2,neammeamorder(j,i)
                  if (lfit) then
                    write(iout,'(22x,f14.6,1x,2(f14.9,1x),3i2)') &
                      (denpar(k,l,j,i),k=1,2),(itmps(7*(i-1)+k,j,l),k=1,2)
                  else
                    write(iout,'(22x,f14.6,1x,2(f14.9,1x))') (denpar(k,l,j,i),k=1,2)
                  endif
                enddo
              endif
            elseif (ndenfn(j,i).eq.10) then
!
!  Mei-Davenport form 
!
              if (neammeamorder(j,i).gt.1) then
                write(iout,'(''meam_density mei-davenport'',i2)') neammeamorder(j,i)-1
                if (lfit) then
                  write(iout,'(2(a5,1x,a4,1x),3(f14.9,1x),''&'')') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,3)
                  write(iout,'(4(f13.8,1x),7i2)') &
                    (denpar(k,1,j,i),k=4,7),(itmps(7*(i-1)+k,j,1),k=1,7)
                else
                  write(iout,'(2(a5,1x,a4,1x),3(f14.9,1x),''&'')') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,3)
                  write(iout,'(2x,4(f14.9,1x))') &
                    (denpar(k,1,j,i),k=4,7)
                endif
              else
                write(iout,'(''eam_density mei-davenport'')')
                if (lfit) then
                  write(iout,'(2(a5,1x,a4,1x),3(f14.9,1x),''&'')') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,3)
                  write(iout,'(10x,4(f14.9,1x),7i2)') &
                    (denpar(k,1,j,i),k=4,7),(itmps(7*(i-1)+k,j,1),k=1,7)
                else
                  write(iout,'(2(a5,1x,a4,1x),3(f14.9,1x),''&'')') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,3)
                  write(iout,'(10x,4(f14.9,1x))') &
                    (denpar(k,1,j,i),k=4,7)
                endif
              endif
              if (neammeamorder(j,i).gt.1) then
                do l = 2,neammeamorder(j,i)
                  if (lfit) then
                    write(iout,'(22x,3(f14.9,1x),''&'')') (denpar(k,l,j,i),k=1,3)
                    write(iout,'(4(f13.8,1x),7i2)') &
                      (denpar(k,l,j,i),k=4,7),(itmps(7*(i-1)+k,j,l),k=1,7)
                  else
                    write(iout,'(22x,3(f14.9,1x),''&'')') (denpar(k,l,j,i),k=1,3)
                    write(iout,'(2x,4(f14.9,1x))') (denpar(k,l,j,i),k=4,7)
                  endif
                enddo
              endif
            elseif (ndenfn(j,i).eq.13) then
!
!  VBO -Chen form
!
              if (neammeamorder(j,i).gt.1) then
                write(iout,'(''meam_density vbo'',i2)') neammeamorder(j,i)-1
                if (lfit) then
                  write(iout,'(2(a5,1x,a4,1x),f12.6,1x,4(f12.6,1x),5i2)') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,5),(itmps(7*(i-1)+k,j,1),k=1,5)
                else
                  write(iout,'(2(a5,1x,a4,1x),f12.6,1x,4(f12.6,1x))') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,5)
                endif
              else
                write(iout,'(''eam_density vbo'')')
                if (lfit) then
                  write(iout,'(2(a5,1x,a4,1x),f12.6,1x,4(f12.6,1x),5i2)') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,5),(itmps(7*(i-1)+k,j,1),k=1,5)
                else
                  write(iout,'(2(a5,1x,a4,1x),f12.6,1x,4(f12.6,1x))') lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,5)
                endif
              endif
              if (neammeamorder(j,i).gt.1) then
                do l = 2,neammeamorder(j,i)
                  if (lfit) then
                    write(iout,'(22x,f12.6,1x,4(f12.6,1x),5i2)') &
                      (denpar(k,l,j,i),k=1,5),(itmps(7*(i-1)+k,j,l),k=1,5)
                  else
                    write(iout,'(22x,f12.6,1x,4(f12.6,1x))') (denpar(k,l,j,i),k=1,5)
                  endif
                enddo
              endif
            elseif (ndenfn(j,i).eq.14) then
!
!  Fpower form
!
              if (neammeamorder(j,i).gt.1) then
                write(iout,'(''meam_density fpower'',i2)') neammeamorder(j,i)-1
                if (lfit) then
                  write(iout,'(2(a5,1x,a4,1x),2(f14.9,1x),2i2)') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,2),(itmps(7*(i-1)+k,j,1),k=1,2)
                else
                  write(iout,'(2(a5,1x,a4,1x),2(f14.9,1x))') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,2)
                endif
              else
                write(iout,'(''eam_density fpower'')')
                if (lfit) then
                  write(iout,'(2(a5,1x,a4,1x),2(f14.9,1x),2i2)') &
                    lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,2),(itmps(7*(i-1)+k,j,1),k=1,2)
                else
                  write(iout,'(2(a5,1x,a4,1x),2(f14.9,1x))') lab1,ctmp(1),lab2,ctmp(2),(denpar(k,1,j,i),k=1,2)
                endif
              endif
              if (neammeamorder(j,i).gt.1) then
                do l = 2,neammeamorder(j,i)
                  if (lfit) then
                    write(iout,'(22x,2(f14.9,1x),3i2)') &
                      (denpar(k,l,j,i),k=1,2),(itmps(7*(i-1)+k,j,l),k=1,2)
                  else
                    write(iout,'(22x,2(f14.9,1x))') (denpar(k,l,j,i),k=1,2)
                  endif
                enddo
              endif
            endif
          endif
        enddo
      else
        do j = 1,ndenfncomp(i)
          if (ndenfn(j,i).gt.0) then
            if (ndenfn(j,i).eq.1) then
!
!  Power law => Sutton-Chen
!
              if (neammeamorder(j,i).gt.1) then
                write(iout,'(''meam_density power'',i2,1x,i2)') neammeamorder(j,i)-1,nint(denpar(6,1,j,i))
                if (lfit) then
                  write(iout,'(a5,1x,a4,1x,f16.6,1x,i2)') &
                    lab1,ctmp(1),denpar(1,1,j,i),itmps(7*(i-1)+1,j,1)
                else
                  write(iout,'(a5,1x,a4,1x,f16.6)') &
                    lab1,ctmp(1),denpar(1,1,j,i)
                endif
              else
                write(iout,'(''eam_density power '',i2)') nint(denpar(6,1,j,i))
                if (lfit) then
                  write(iout,'(a5,1x,a4,1x,f16.6,i2)') lab1,ctmp(1),denpar(1,1,j,i),itmps(7*(i-1)+1,j,1)
                else
                  write(iout,'(a5,1x,a4,1x,f16.6)') lab1,ctmp(1),denpar(1,1,j,i)
                endif
              endif
              if (neammeamorder(j,i).gt.1) then
                do l = 2,neammeamorder(j,i)
                  if (lfit) then
                    write(iout,'(11x,f16.6,1x,i2)') denpar(1,l,j,i),itmps(7*(i-1)+1,j,l)
                  else
                    write(iout,'(11x,f16.6)') denpar(1,l,j,i)
                  endif
                enddo
              endif
            elseif (ndenfn(j,i).eq.2.or.ndenfn(j,i).eq.12) then
!
!  Exponential / Baskes
!
              if (ndenfn(j,i).eq.2) then
                if (neammeamorder(j,i).gt.1) then
                  write(iout,'(''meam_density exponential '',i2,1x,i2)') neammeamorder(j,i)-1,nint(denpar(6,1,j,i))
                else
                  write(iout,'(''eam_density exponential '',i2)') nint(denpar(6,1,j,i))
                endif
              else
                if (neammeamorder(j,i).gt.1) then
                  write(iout,'(''meam_density baskes '',i2)') neammeamorder(j,i)-1
                else
                  write(iout,'(''eam_density baskes '')')
                endif
              endif
              if (neammeamorder(j,i).gt.1) then
                if (lfit) then
                  write(iout,'(a5,1x,a4,1x,f14.6,1x,2(f10.5,1x),3i2)') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,3),(itmps(7*(i-1)+k,j,1),k=1,3)
                else
                  write(iout,'(a5,1x,a4,1x,f14.6,1x,2(f10.5,1x))') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,3)
                endif
              else
                if (lfit) then
                  write(iout,'(a5,1x,a4,1x,f14.6,1x,2(f10.5,1x),3i2)') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,3),(itmps(7*(i-1)+k,j,1),k=1,3)
                else
                  write(iout,'(a5,1x,a4,1x,f14.6,1x,2(f10.5,1x))')lab1,ctmp(1),(denpar(k,1,j,i),k=1,3)
                endif
              endif
              if (neammeamorder(j,i).gt.1) then
                do l = 2,neammeamorder(j,i)
                  if (lfit) then
                    write(iout,'(11x,f14.6,1x,2(f10.5,1x),3i2)') &
                      (denpar(k,l,j,i),k=1,3),(itmps(7*(i-1)+k,j,l),k=1,3)
                  else
                    write(iout,'(11x,f14.6,1x,2(f10.5,1x))') (denpar(k,l,j,i),k=1,3)
                  endif
                enddo
              endif
            elseif (ndenfn(j,i).eq.3) then
!
!  Gaussian
!
              if (neammeamorder(j,i).gt.1) then
                write(iout,'(''meam_density gaussian'',i2,1x,i2)') neammeamorder(j,i)-1,nint(denpar(6,1,j,i))
                if (lfit) then
                  write(iout,'(a5,1x,a4,1x,f14.6,1x,2(f10.5,1x),3i2)') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,3),(itmps(7*(i-1)+k,j,1),k=1,3)
                else
                  write(iout,'(a5,1x,a4,1x,f14.6,1x,2(f10.5,1x))') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,3)
                endif
              else
                write(iout,'(''eam_density gaussian '',i2)') nint(denpar(6,1,j,i))
                if (lfit) then
                  write(iout,'(a5,1x,a4,1x,f14.6,1x,2(f10.5,1x),3i2)') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,3),(itmps(7*(i-1)+k,j,1),k=1,3)
                else
                  write(iout,'(a5,1x,a4,1x,f14.6,1x,2(f10.5,1x))')lab1,ctmp(1),(denpar(k,1,j,i),k=1,3)
                endif
              endif
              if (neammeamorder(j,i).gt.1) then
                do l = 2,neammeamorder(j,i)
                  if (lfit) then
                    write(iout,'(11x,f14.6,1x,2(f10.5,1x),3i2)') &
                      (denpar(k,l,j,i),k=1,3),(itmps(7*(i-1)+k,j,l),k=1,3)
                  else
                    write(iout,'(11x,f14.6,1x,2(f10.5,1x))') (denpar(k,l,j,i),k=1,3)
                  endif
                enddo
              endif
            elseif (ndenfn(j,i).eq.4) then
!
!  Cubic form
!
              if (neammeamorder(j,i).gt.1) then
                write(iout,'(''meam_density cubic'',i2)') neammeamorder(j,i)-1
                if (lfit) then
                  write(iout,'(a5,1x,a4,1x,f14.6,1x,2(f14.9,1x),3i2)') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,2),(itmps(7*(i-1)+k,j,1),k=1,2)
                else
                  write(iout,'(a5,1x,a4,1x,f14.6,1x,2(f14.9,1x))') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,2)
                endif
              else
                write(iout,'(''eam_density cubic'')')
                if (lfit) then
                  write(iout,'(a5,1x,a4,1x,f14.6,1x,2(f14.9,1x),3i2)') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,2),(itmps(7*(i-1)+k,j,1),k=1,2)
                else
                  write(iout,'(a5,1x,a4,1x,f14.6,1x,2(f14.9,1x))') lab1,ctmp(1),(denpar(k,1,j,i),k=1,2)
                endif
              endif
              if (neammeamorder(j,i).gt.1) then
                do l = 2,neammeamorder(j,i)
                  if (lfit) then
                    write(iout,'(11x,f14.6,1x,2(f14.9,1x),3i2)') &
                      (denpar(k,l,j,i),k=1,2),(itmps(7*(i-1)+k,j,l),k=1,2)
                  else
                    write(iout,'(11x,f14.6,1x,2(f14.9,1x))') (denpar(k,l,j,i),k=1,2)
                  endif
                enddo
              endif
            elseif (ndenfn(j,i).eq.5) then
!
!  Voter-Chen form
!
              if (neammeamorder(j,i).gt.1) then
                write(iout,'(''meam_density voter'',i2)') neammeamorder(j,i)-1
                if (lfit) then
                  write(iout,'(a5,1x,a4,1x,f14.6,1x,2(f14.9,1x),3i2)') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,2),(itmps(7*(i-1)+k,j,1),k=1,2)
                else
                  write(iout,'(a5,1x,a4,1x,f14.6,1x,2(f14.9,1x))') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,2)
                endif
              else
                write(iout,'(''eam_density voter'')')
                if (lfit) then
                  write(iout,'(a5,1x,a4,1x,f14.6,1x,2(f14.9,1x),3i2)') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,2),(itmps(7*(i-1)+k,j,1),k=1,2)
                else
                  write(iout,'(a5,1x,a4,1x,f14.6,1x,2(f14.9,1x))') lab1,ctmp(1),(denpar(k,1,j,i),k=1,2)
                endif
              endif
              if (neammeamorder(j,i).gt.1) then
                do l = 2,neammeamorder(j,i)
                  if (lfit) then
                    write(iout,'(11x,f14.6,1x,2(f14.9,1x),3i2)') &
                      (denpar(k,l,j,i),k=1,2),(itmps(7*(i-1)+k,j,l),k=1,2)
                  else
                    write(iout,'(11x,f14.6,1x,2(f14.9,1x))') (denpar(k,l,j,i),k=1,2)
                  endif
                enddo
              endif
            elseif (ndenfn(j,i).eq.6) then
!
!  Quadratic form
!
              if (neammeamorder(j,i).gt.1) then
                write(iout,'(''meam_density quadratic'',i2)') neammeamorder(j,i)-1
                if (lfit) then
                  write(iout,'(a5,1x,a4,1x,2(f14.9,1x),2i2)') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,2),(itmps(7*(i-1)+k,j,1),k=1,2)
                else
                  write(iout,'(a5,1x,a4,1x,2(f14.9,1x))') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,2)
                endif
              else
                write(iout,'(''eam_density quadratic'')')
                if (lfit) then
                  write(iout,'(a5,1x,a4,1x,2(f14.9,1x),2i2)') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,2),(itmps(7*(i-1)+k,j,1),k=1,2)
                else
                  write(iout,'(a5,1x,a4,1x,2(f14.9,1x))') lab1,ctmp(1),(denpar(k,1,j,i),k=1,2)
                endif
              endif
              if (neammeamorder(j,i).gt.1) then
                do l = 2,neammeamorder(j,i)
                  if (lfit) then
                    write(iout,'(11x,2(f14.9,1x),2i2)') &
                      (denpar(k,l,j,i),k=1,2),(itmps(7*(i-1)+k,j,l),k=1,2)
                  else
                    write(iout,'(11x,2(f14.9,1x))') (denpar(k,l,j,i),k=1,2)
                  endif
                enddo
              endif
            elseif (ndenfn(j,i).eq.7) then
!
!  Quartic form
!
              if (neammeamorder(j,i).gt.1) then
                write(iout,'(''meam_density quartic'',i2)') neammeamorder(j,i)-1
                if (lfit) then
                  write(iout,'(a5,1x,a4,1x,2(f14.9,1x),2i2)') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,2),(itmps(7*(i-1)+k,j,1),k=1,2)
                else
                  write(iout,'(a5,1x,a4,1x,2(f14.9,1x))') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,2)
                endif
              else
                write(iout,'(''eam_density quartic'')')
                if (lfit) then
                  write(iout,'(a5,1x,a4,1x,2(f14.9,1x),2i2)') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,2),(itmps(7*(i-1)+k,j,1),k=1,2)
                else
                  write(iout,'(a5,1x,a4,1x,2(f14.9,1x))') lab1,ctmp(1),(denpar(k,1,j,i),k=1,2)
                endif
              endif
              if (neammeamorder(j,i).gt.1) then
                do l = 2,neammeamorder(j,i)
                  if (lfit) then
                    write(iout,'(11x,2(f14.9,1x),2i2)') &
                      (denpar(k,l,j,i),k=1,2),(itmps(7*(i-1)+k,j,l),k=1,2)
                  else
                    write(iout,'(11x,2(f14.9,1x))') (denpar(k,l,j,i),k=1,2)
                  endif
                enddo
              endif
            elseif (ndenfn(j,i).eq.8) then
!
!  Glue polynomial form
!
              if (neammeamorder(j,i).gt.1) then
                write(iout,'(''meam_density glue'',i2)') neammeamorder(j,i)-1
                write(iout,'(a5,1x,a4,1x,3(f14.10,1x))') lab1,ctmp(1),(denpar(k,1,j,i),k=1,3)
              else
                write(iout,'(''eam_density glue'')')
                write(iout,'(a5,1x,a4,1x,3(f14.10,1x))') lab1,ctmp(1),(denpar(k,1,j,i),k=1,3)
              endif
              write(iout,'(4(f18.12,1x))') (denpar(k,1,j,i),k=4,7)
              write(iout,'(4(f18.12,1x))') (denpar(k,1,j,i),k=8,11)
              write(iout,'(4(f18.12,1x))') (denpar(k,1,j,i),k=12,15)
              if (neammeamorder(j,i).gt.1) then
                do l = 2,neammeamorder(j,i)
                  write(iout,'(11x,3(f14.10,1x))') (denpar(k,l,j,i),k=1,3)
                  write(iout,'(4(f18.12,1x))') (denpar(k,l,j,i),k=4,7)
                  write(iout,'(4(f18.12,1x))') (denpar(k,l,j,i),k=8,11)
                  write(iout,'(4(f18.12,1x))') (denpar(k,l,j,i),k=12,15)
                enddo
              endif
            elseif (ndenfn(j,i).eq.9) then
!
!  Voter-Chen form with exponential
!
              if (neammeamorder(j,i).gt.1) then
                write(iout,'(''meam_density evoter'',i2)') neammeamorder(j,i)-1
                if (lfit) then
                  write(iout,'(a5,1x,a4,1x,f14.6,1x,2(f14.9,1x),3i2)') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,2),(itmps(7*(i-1)+k,j,1),k=1,2)
                else
                  write(iout,'(a5,1x,a4,1x,f14.6,1x,2(f14.9,1x))') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,2)
                endif
              else
                write(iout,'(''eam_density evoter'')')
                if (lfit) then
                  write(iout,'(a5,1x,a4,1x,f14.6,1x,2(f14.9,1x),3i2)') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,2),(itmps(7*(i-1)+k,j,1),k=1,2)
                else
                  write(iout,'(a5,1x,a4,1x,f14.6,1x,2(f14.9,1x))') lab1,ctmp(1),(denpar(k,1,j,i),k=1,2)
                endif
              endif
              if (neammeamorder(j,i).gt.1) then
                do l = 2,neammeamorder(j,i)
                  if (lfit) then
                    write(iout,'(11x,f14.6,1x,2(f14.9,1x),3i2)') &
                      (denpar(k,l,j,i),k=1,2),(itmps(7*(i-1)+k,j,l),k=1,2)
                  else
                    write(iout,'(11x,f14.6,1x,2(f14.9,1x))') (denpar(k,l,j,i),k=1,2)
                  endif
                enddo
              endif
            elseif (ndenfn(j,i).eq.10) then
!
!  Mei-Davenport form 
!
              if (neammeamorder(j,i).gt.1) then
                write(iout,'(''meam_density mei-davenport'',i2)') neammeamorder(j,i)-1
                if (lfit) then
                  write(iout,'(a5,1x,a4,1x,3(f14.9,1x),''&'')') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,3)
                  write(iout,'(4(f13.8,1x),7i2)') &
                    (denpar(k,1,j,i),k=4,7),(itmps(7*(i-1)+k,j,1),k=1,7)
                else
                  write(iout,'(a5,1x,a4,1x,3(f14.9,1x),''&'')') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,3)
                  write(iout,'(2x,4(f14.9,1x))') &
                    (denpar(k,1,j,i),k=4,7)
                endif
              else
                write(iout,'(''eam_density mei-davenport'')')
                if (lfit) then
                  write(iout,'(a5,1x,a4,1x,3(f14.9,1x),''&'')') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,3)
                  write(iout,'(11x,4(f14.9,1x),7i2)') &
                    (denpar(k,1,j,i),k=4,7),(itmps(7*(i-1)+k,j,1),k=1,7)
                else
                  write(iout,'(a5,1x,a4,1x,3(f14.9,1x),''&'')') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,3)
                  write(iout,'(11x,4(f14.9,1x))') &
                    (denpar(k,1,j,i),k=4,7)
                endif
              endif
              if (neammeamorder(j,i).gt.1) then
                do l = 2,neammeamorder(j,i)
                  if (lfit) then
                    write(iout,'(11x,3(f14.9,1x),''&'')') (denpar(k,l,j,i),k=1,3)
                    write(iout,'(4(f13.8,1x),7i2)') &
                      (denpar(k,l,j,i),k=4,7),(itmps(7*(i-1)+k,j,l),k=1,7)
                  else
                    write(iout,'(11x,3(f14.9,1x),''&'')') (denpar(k,l,j,i),k=1,3)
                    write(iout,'(2x,4(f14.9,1x))') (denpar(k,l,j,i),k=4,7)
                  endif
                enddo
              endif
            elseif (ndenfn(j,i).eq.13) then
!
!  VBO form
!
              if (neammeamorder(j,i).gt.1) then
                write(iout,'(''meam_density vbo'',i2)') neammeamorder(j,i)-1
                if (lfit) then
                  write(iout,'(a5,1x,a4,1x,f12.6,1x,4(f12.6,1x),5i2)') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,5),(itmps(7*(i-1)+k,j,1),k=1,5)
                else
                  write(iout,'(a5,1x,a4,1x,f12.6,1x,4(f12.6,1x))') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,5)
                endif
              else
                write(iout,'(''eam_density vbo'')')
                if (lfit) then
                  write(iout,'(a5,1x,a4,1x,f12.6,1x,4(f12.6,1x),5i2)') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,5),(itmps(7*(i-1)+k,j,1),k=1,5)
                else
                  write(iout,'(a5,1x,a4,1x,f12.6,1x,4(f12.6,1x))') lab1,ctmp(1),(denpar(k,1,j,i),k=1,5)
                endif
              endif
              if (neammeamorder(j,i).gt.1) then
                do l = 2,neammeamorder(j,i)
                  if (lfit) then
                    write(iout,'(11x,f12.6,1x,4(f12.6,1x),5i2)') &
                      (denpar(k,l,j,i),k=1,5),(itmps(7*(i-1)+k,j,l),k=1,5)
                  else
                    write(iout,'(11x,f12.6,1x,4(f12.6,1x))') (denpar(k,l,j,i),k=1,5)
                  endif
                enddo
              endif
            elseif (ndenfn(j,i).eq.14) then
!
!  Fpower form
!
              if (neammeamorder(j,i).gt.1) then
                write(iout,'(''meam_density fpower '',i2)') neammeamorder(j,i)-1
                if (lfit) then
                  write(iout,'(a5,1x,a4,1x,2(f14.9,1x),2i2)') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,2),(itmps(7*(i-1)+k,j,1),k=1,2)
                else
                  write(iout,'(a5,1x,a4,1x,2(f14.9,1x))') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,2)
                endif
              else
                write(iout,'(''eam_density fpower'')')
                if (lfit) then
                  write(iout,'(a5,1x,a4,1x,2(f14.9,1x),2i2)') &
                    lab1,ctmp(1),(denpar(k,1,j,i),k=1,2),(itmps(7*(i-1)+k,j,1),k=1,2)
                else
                  write(iout,'(a5,1x,a4,1x,2(f14.9,1x))') lab1,ctmp(1),(denpar(k,1,j,i),k=1,2)
                endif
              endif
              if (neammeamorder(j,i).gt.1) then
                do l = 2,neammeamorder(j,i)
                  if (lfit) then
                    write(iout,'(11x,2(f14.9,1x),2i2)') &
                      (denpar(k,l,j,i),k=1,2),(itmps(7*(i-1)+k,j,l),k=1,2)
                  else
                    write(iout,'(11x,2(f14.9,1x))') (denpar(k,l,j,i),k=1,2)
                  endif
                enddo
              endif
            endif
          endif
        enddo
      endif
    enddo
  endif
  if (lMEAMscreen) then
!******************************
!  MEAM screening parameters  *
!******************************
    write(iout,'(''meam_screening '',f12.6,1x,f12.6)') meam_Cmin, meam_Cmax
  endif
!*************************
!  EAM alloy parameters  *
!*************************
  if (neamspec.gt.0) then
    if (lfit) then
      do i = 1,2*neamspec
        itmps(i,1,1) = 0
      enddo
      do i = 1,nfit
        nt = nftyp(i)
        if (nt.eq.5) then
          nv = nfvar(i)
          if (nv.ge.7.and.nv.le.8) then
            np = nfpot(i)       
            itmps(2*(np-1)+nv-6,1,1) = 1
          endif
        endif
      enddo    
    endif
    do i = 1,neamspec
      if (eamalloy(1,i).ne.1.0_dp.or.eamalloy(2,i).ne.0.0_dp) then
        nat1 = neamnat(i)
        itype1 = neamtyp(i)
        if (llibsymdump) then
          lab1 = symboleamspec(1,i)
        else
          call label(nat1,itype1,lab1)
        endif
        if (nat1.gt.maxele) then
          ctmp(1) = 'shel'
        else
          ctmp(1) = 'core'
        endif
!
        write(iout,'(''eam_alloy'')')
        if (lfit) then
          write(iout,'(a5,1x,a4,1x,f10.5,1x,i2)') lab1,ctmp(1),eamalloy(1,i),itmps(2*(i-1)+1,1,1)
!              write(iout,'(a5,1x,a4,1x,2(f10.5,1x),2i2)')
!     &          lab1,ctmp(1),(eamalloy(j,i),j=1,2),(itmps(2*(i-1)+j,1,1),j=1,2)
        else
          write(iout,'(a5,1x,a4,1x,f10.5,1x)') lab1,ctmp(1),eamalloy(1,i)
!              write(iout,'(a5,1x,a4,1x,2(f10.5,1x))') lab1,ctmp(1),(eamalloy(j,i),j=1,2)
        endif
      endif
    enddo
  endif
!***************************
!  Bond charge increments  *
!***************************
  if (nlib.gt.0.and..not.llibdump) then
    nbondQo = nlibbondQ
  else
    nbondQo = nbondQ
  endif
  if (nbondQo.gt.0) then
    if (lfit) then
      do i = 1,nbondQo
        itmp(i) = 0
      enddo
      do i = 1,nfit
        nt = nftyp(i)
        np = nfpot(i)
        if (nt.eq.1.and.np.eq.27) then
          nv = nfvar(i)
          itmp(nv) = 1
        endif
      enddo
    endif
    do i = 1,nbondQo
!
!  General potential details
!
      nat1 = nbondQspec1(i)
      itype1 = nbondQtyp1(i)
      if (llibsymdump) then
        lab1 = symbolbondQ(1,i)
      else
        call label(nat1,itype1,lab1)
      endif
      if (nat1.gt.maxele) then
        ctmp(1) = 'shel'
      else
        ctmp(1) = 'core'
      endif
      nat2 = nbondQspec2(i)
      itype2 = nbondQtyp2(i)
      if (llibsymdump) then
        lab2 = symbol2(2,i)
      else
        call label(nat2,itype2,lab2)
      endif
      if (nat2.gt.maxele) then
        ctmp(2) = 'shel'
      else
        ctmp(2) = 'core'
      endif
!
      if (lfit) then
        write(iout,'(''qincrement '',a5,1x,a4,1x,a5,1x,a4,1x,f14.8,i2)') &
              lab1,ctmp(1),lab2,ctmp(2),bondQincrement(i),itmp(i)
      else
        write(iout,'(''qincrement '',a5,1x,a4,1x,a5,1x,a4,1x,f14.8)') &
              lab1,ctmp(1),lab2,ctmp(2),bondQincrement(i)
      endif
    enddo
  endif
!*********************
!  Plane potentials  *
!*********************
  if (nplanepot.gt.0) then
    if (lfit) then
      do i = 1,2*nplanepot
        itmp(i) = 0
      enddo
      do i = 1,nfit
        nt = nftyp(i)
        if (nt.eq.1) then
          np = nfpot(i)
          nv = nfvar(i)
          if (np.eq.28) itmp(2*(nv-1)+1) = 1
          if (np.eq.29) itmp(2*(nv-1)+2) = 1
        endif
      enddo
    endif
    do i = 1,nplanepot
      nat1 = natplanepot(i)
      itype1 = ntypplanepot(i)
      if (llibsymdump) then
        lab1 = planepotsymbol(i)
      else
        call label(nat1,itype1,lab1)
      endif
      if (nat1.gt.maxele) then
        ctmp(1) = 'shel'
      else
        ctmp(1) = 'core'
      endif
      if (nplanepottype(i).eq.1) then
        write(iout,'(''plane_lj '',i4,1x,i4)') (nplanepotpower(j,i),j=1,2)
        if (lfit) then
          write(iout,'(a5,1x,a4,3(1x,f14.8),2(1x,f8.4),2i2)') &
            lab1,ctmp(1),(planepot(j,i),j=1,3),planepotrmin(i),planepotrmax(i),itmp(2*(i-1)+1),itmp(2*(i-1)+2)
        else
          write(iout,'(a5,1x,a4,3(1x,f14.8),2(1x,f8.4))') &
            lab1,ctmp(1),(planepot(j,i),j=1,3),planepotrmin(i),planepotrmax(i)
        endif
      endif
    enddo
  endif
!******************************************
!  Three-, four-, and six-body potentials *
!******************************************
  if ((nthb+nfor+nsix).gt.0) call dump34(iout)
!*************************
!  Bond order potentials *
!*************************
  if ((nbopot+nboA+nboR+nboQ+nboQ0+nCCspec+nreaxFFspec+nEDIPspec).gt.0) call dumpbo(iout)
!
!  Free local memory
!
  deallocate(itmps,stat=status)
  if (status/=0) call deallocate_error('dumppot','itmps')
  deallocate(itmp,stat=status)
  if (status/=0) call deallocate_error('dumppot','itmp')
  deallocate(ctmp,stat=status)
  if (status/=0) call deallocate_error('dumppot','ctmp')
!
  return
  end
